function Feature(e,t,a,n){var i=null,i=n==Feature.INCLUSIVESHAPE?["InclusionSphere"]:n==Feature.EXCLUSIVESHAPE?["ExclusionSphere"]:["Aromatic","HydrogenDonor","HydrogenAcceptor","Hydrophobic","NegativeIon","PositiveIon"],r=this;this.obj={},this.shape=null,this.selected=!1,this.updateViewer=function(){},this.container=$("<div>").appendTo(t).addClass("pharmit_featurediv"),(this.container.get(0).feature=this).container.disableSelection();var o=$("<h3></h3>").appendTo(this.container);this.enabled=$("<div>").addClass("toggle toggle-light pharmit_togglediv").appendTo(o).toggles().on("toggle",function(e,t){t?(r.obj.enabled=!0,r.container.addClass("pharmit_enabledfeature")):(r.obj.enabled=!1,r.container.removeClass("pharmit_enabledfeature")),r.updateViewer()}).click(function(e){return!1});var s=$("<div>").addClass("pharmit_featurenamediv").appendTo(o),l=$("<span>").addClass("pharmit_featurenameheading").appendTo(s),n=$("<div>").addClass("pharmit_featureclose").appendTo(o).click(function(){r.deleteFeature()}),o=($("<span>").addClass("ui-icon-circle-close ui-icon").appendTo(n),$("<span>").appendTo(s).addClass("pharmit_featuresummary"));this.customlabel=$("<span>").appendTo(o).addClass("pharmit_customlabel"),o.append($(document.createTextNode("("))),this.xsummary=$("<span>").appendTo(o),o.append($(document.createTextNode(","))),this.ysummary=$("<span>").appendTo(o),o.append($(document.createTextNode(","))),this.zsummary=$("<span>").appendTo(o),o.append($(document.createTextNode(") r="))),this.rsummary=$("<span>").appendTo(o);var n=$("<div>").appendTo(this.container),d=this.select=$("<select>").addClass("pharmit_featureselect").appendTo(n);$.each(i,function(e,t){$('<option value="'+t+'">'+t+"</option>").appendTo(d)}),d.change(function(){var e=this.value;r.obj.name=e,l.text(e),"Aromatic"==e||"HydrogenDonor"==e||"HydrogenAcceptor"==e?(r.orientdiv.show(),r.sizediv.hide(),r.obj.hasvec=!0):("Hydrophobic"==e?(r.orientdiv.hide(),r.sizediv.show()):(r.orientdiv.hide(),r.sizediv.hide()),r.obj.hasvec=!1),r.updateViewer()}),d.selectmenu({width:"15em",change:function(){d.trigger("change")}}),i.length<=1&&d.next(".ui-selectmenu-button").hide();function p(e,t){if($.isNumeric(e.value)){e=parseFloat(e.value);return t&&t.text(numeral(e).format("0.0")),Math.round(1e3*e)/1e3}}s=$("<div>").appendTo(n).addClass("pharmit_locationdiv"),o=function(e,t){return t.spin=t.stop=t.change=function(){e.change()},t},i=$("<div>").appendTo(s).addClass("pharmit_coorddiv");$("<label>x:</label>").appendTo(i),this.x=$("<input>").appendTo(i).addClass("pharmit_coordinput").change(function(){r.obj.x=p(this,r.xsummary),r.updateViewer()}),this.x.spinner(o(r.x,{step:.1,numberFormat:"n"})),i=$("<div>").appendTo(s).addClass("pharmit_coorddiv"),$("<label>y:</label>").appendTo(i),this.y=$("<input>").appendTo(i).addClass("pharmit_coordinput"),this.y.spinner(o(r.y,{step:.1,numberFormat:"n"})).change(function(){r.obj.y=p(this,r.ysummary),r.updateViewer()}),i=$("<div>").appendTo(s).addClass("pharmit_coorddiv"),$("<label>z:</label>").appendTo(i),this.z=$("<input>").appendTo(i).addClass("pharmit_coordinput"),this.z.spinner(o(r.z,{step:.1,numberFormat:"n"})).change(function(){r.obj.z=p(this,r.zsummary),r.updateViewer()}),i=$("<div>").appendTo(s).addClass("pharmit_coorddiv"),$("<label>r=</label>").appendTo(i),this.radius=$("<input>").appendTo(i).addClass("pharmit_radiusinput"),this.radius.spinner(o(r.radius,{step:.1,numberFormat:"n"})).change(function(){r.obj.radius=p(this,r.rsummary),r.updateViewer()});function c(){var e=Math.round(parseFloat(u.val()))%360,t=Math.round(parseFloat(h.val()))%360;isNaN(e)&&(e=0),isNaN(t)&&(t=0),u.val(e),h.val(t),t=t*Math.PI/180,e=e*Math.PI/180,r.obj.svector={x:Math.sin(t)*Math.cos(e),y:Math.sin(t)*Math.sin(e),z:Math.cos(t)},r.updateViewer()}var s=this.orientdiv=$("<div>").appendTo(n).addClass("pharmit_orientdiv"),h=null,u=null;this.orientenabled=$('<input type="checkbox">').appendTo(s).change(function(){$(this).prop("checked")?(h.spinner("option","disabled",!1),u.spinner("option","disabled",!1),r.obj.vector_on=1):(h.spinner("option","disabled",!0),u.spinner("option","disabled",!0),r.obj.vector_on=0,c()),r.updateViewer()});i=$("<span>").addClass("pharmit_nowrap").appendTo(s);$("<label>&theta;:</label>").appendTo(i),h=this.theta=$("<input>").appendTo(i).addClass("pharmit_orientinput"),this.theta.spinner(o(r.theta,{step:1,numberFormat:"n"})).change(c),i=$("<span>").addClass("pharmit_nowrap").appendTo(s),$("<label>&phi;:</label>").appendTo(i),u=this.phi=$("<input>").appendTo(i).addClass("pharmit_orientinput"),this.phi.spinner(o(r.theta,{step:1,numberFormat:"n"})).change(c),this.orientdiv.hide();n=this.sizediv=$("<div>").appendTo(n).addClass("pharmit_sizediv");this.minsize=$("<input>").appendTo(n).addClass("pharmit_sizeinput"),this.minsize.spinner(o(r.minsize,{step:1,numberFormat:"n"})).change(function(){r.obj.minsize=this.value,r.updateViewer()}),$("<label> &le; #Atoms &le;</label>").appendTo(n).addClass("pharmit_nowrap"),this.maxsize=$("<input>").appendTo(n).addClass("pharmit_sizeinput"),this.maxsize.spinner(o(r.maxsize,{step:1,numberFormat:"n"})).change(function(){r.obj.maxsize=this.value,r.updateViewer()}),this.sizediv.hide(),this.setFeature(a),delete this.updateViewer,this.viewer=e,this.updateViewer(),t.accordion("refresh"),t.accordion("option","active",t.children().length-1)}Feature.INCLUSIVESHAPE=1,Feature.EXCLUSIVESHAPE=2,Feature.prototype.setFeature=function(e){var t,a,n;this.select.val(e.name).trigger("change"),this.select.selectmenu("refresh"),this.x.val(e.x).trigger("change"),this.y.val(e.y).trigger("change"),this.z.val(e.z).trigger("change"),this.radius.val(e.radius).trigger("change"),this.enabled.toggles(e.enabled),this.obj.enabled=!!e.enabled,this.orientenabled.prop("checked",1==e.vector_on).trigger("change"),$.isNumeric(e.minsize)?this.minsize.val(e.minsize).trigger("change"):this.obj.minsize="",$.isNumeric(e.maxsize)?this.maxsize.val(e.maxsize).trigger("change"):this.obj.maxsize="",e.svector?(n=e.svector.x,t=e.svector.y,a=e.svector.z,a=180*Math.acos(a/Math.sqrt(n*n+t*t+a*a))/Math.PI,n=180*Math.atan2(t,n)/Math.PI,this.theta.val(a).trigger("change"),this.phi.val(n).trigger("change")):this.obj.svector={x:1,y:0,z:0},e.label&&(this.customlabel.val(e.label),this.customlabel.text(e.label+" "))},Feature.prototype.hideFeature=function(){this.obj.hidden=!0,null!==this.shape&&this.viewer.removeFeature(this.shape),this.updateViewer()},Feature.prototype.unhideFeature=function(){this.obj.hidden=!1,this.updateViewer()},Feature.prototype.updateViewer=function(){var e;null!==this.shape&&(this.viewer.removeFeature(this.shape),this.shape=null),this.obj.enabled&&!this.obj.hidden&&((e=this).shape=this.viewer.addFeature(this.obj,function(){e.selected?e.deselectFeature():e.selectFeature()}))},Feature.prototype.selectFeature=function(){this.viewer.selectFeature(this.shape),this.container.addClass("pharmit_selectedFeature"),this.selected=!0,this.obj.selected=!0},Feature.prototype.deselectFeature=function(){this.viewer.unselectFeature(this.shape),this.container.removeClass("pharmit_selectedFeature"),this.selected=!1,this.obj.selected=!1},Feature.prototype.deleteFeature=function(){null!==this.shape&&this.viewer.removeFeature(this.shape),this.container.feature=null,this.container.remove()};var Pharmit=Pharmit||{};function Message(e,t,a){var n=t,i=a,r=e,o=0;function s(e){"ack2"==e.data&&(o=1)}window.addEventListener("message",s),t.postMessage("ack",a),setTimeout(function e(){o?(n.postMessage(r,i),r=i="",n=null,o=0,window.removeEventListener("message",s)):n&&(n.postMessage("ack",i),setTimeout(e,250))},250)}!function(){var r=0;function e(e){return a(t(n(e)))}function t(e){return o(s(i(e),8*e.length))}function a(e){for(var t,a=r?"0123456789ABCDEF":"0123456789abcdef",n="",i=0;i<e.length;i++)t=e.charCodeAt(i),n+=a.charAt(t>>>4&15)+a.charAt(15&t);return n}function n(e){for(var t,a,n="",i=-1;++i<e.length;)t=e.charCodeAt(i),a=i+1<e.length?e.charCodeAt(i+1):0,55296<=t&&t<=56319&&56320<=a&&a<=57343&&(t=65536+((1023&t)<<10)+(1023&a),i++),t<=127?n+=String.fromCharCode(t):t<=2047?n+=String.fromCharCode(192|t>>>6&31,128|63&t):t<=65535?n+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):t<=2097151&&(n+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return n}function i(e){for(var t=Array(e.length>>2),a=0;a<t.length;a++)t[a]=0;for(a=0;a<8*e.length;a+=8)t[a>>5]|=(255&e.charCodeAt(a/8))<<a%32;return t}function o(e){for(var t="",a=0;a<32*e.length;a+=8)t+=String.fromCharCode(e[a>>5]>>>a%32&255);return t}function s(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var a=1732584193,n=-271733879,i=-1732584194,r=271733878,o=0;o<e.length;o+=16){var s=a,l=n,d=i,p=r,a=c(a,n,i,r,e[o+0],7,-680876936),r=c(r,a,n,i,e[o+1],12,-389564586),i=c(i,r,a,n,e[o+2],17,606105819),n=c(n,i,r,a,e[o+3],22,-1044525330);a=c(a,n,i,r,e[o+4],7,-176418897),r=c(r,a,n,i,e[o+5],12,1200080426),i=c(i,r,a,n,e[o+6],17,-1473231341),n=c(n,i,r,a,e[o+7],22,-45705983),a=c(a,n,i,r,e[o+8],7,1770035416),r=c(r,a,n,i,e[o+9],12,-1958414417),i=c(i,r,a,n,e[o+10],17,-42063),n=c(n,i,r,a,e[o+11],22,-1990404162),a=c(a,n,i,r,e[o+12],7,1804603682),r=c(r,a,n,i,e[o+13],12,-40341101),i=c(i,r,a,n,e[o+14],17,-1502002290),a=h(a,n=c(n,i,r,a,e[o+15],22,1236535329),i,r,e[o+1],5,-165796510),r=h(r,a,n,i,e[o+6],9,-1069501632),i=h(i,r,a,n,e[o+11],14,643717713),n=h(n,i,r,a,e[o+0],20,-373897302),a=h(a,n,i,r,e[o+5],5,-701558691),r=h(r,a,n,i,e[o+10],9,38016083),i=h(i,r,a,n,e[o+15],14,-660478335),n=h(n,i,r,a,e[o+4],20,-405537848),a=h(a,n,i,r,e[o+9],5,568446438),r=h(r,a,n,i,e[o+14],9,-1019803690),i=h(i,r,a,n,e[o+3],14,-187363961),n=h(n,i,r,a,e[o+8],20,1163531501),a=h(a,n,i,r,e[o+13],5,-1444681467),r=h(r,a,n,i,e[o+2],9,-51403784),i=h(i,r,a,n,e[o+7],14,1735328473),a=u(a,n=h(n,i,r,a,e[o+12],20,-1926607734),i,r,e[o+5],4,-378558),r=u(r,a,n,i,e[o+8],11,-2022574463),i=u(i,r,a,n,e[o+11],16,1839030562),n=u(n,i,r,a,e[o+14],23,-35309556),a=u(a,n,i,r,e[o+1],4,-1530992060),r=u(r,a,n,i,e[o+4],11,1272893353),i=u(i,r,a,n,e[o+7],16,-155497632),n=u(n,i,r,a,e[o+10],23,-1094730640),a=u(a,n,i,r,e[o+13],4,681279174),r=u(r,a,n,i,e[o+0],11,-358537222),i=u(i,r,a,n,e[o+3],16,-722521979),n=u(n,i,r,a,e[o+6],23,76029189),a=u(a,n,i,r,e[o+9],4,-640364487),r=u(r,a,n,i,e[o+12],11,-421815835),i=u(i,r,a,n,e[o+15],16,530742520),a=m(a,n=u(n,i,r,a,e[o+2],23,-995338651),i,r,e[o+0],6,-198630844),r=m(r,a,n,i,e[o+7],10,1126891415),i=m(i,r,a,n,e[o+14],15,-1416354905),n=m(n,i,r,a,e[o+5],21,-57434055),a=m(a,n,i,r,e[o+12],6,1700485571),r=m(r,a,n,i,e[o+3],10,-1894986606),i=m(i,r,a,n,e[o+10],15,-1051523),n=m(n,i,r,a,e[o+1],21,-2054922799),a=m(a,n,i,r,e[o+8],6,1873313359),r=m(r,a,n,i,e[o+15],10,-30611744),i=m(i,r,a,n,e[o+6],15,-1560198380),n=m(n,i,r,a,e[o+13],21,1309151649),a=m(a,n,i,r,e[o+4],6,-145523070),r=m(r,a,n,i,e[o+11],10,-1120210379),i=m(i,r,a,n,e[o+2],15,718787259),n=m(n,i,r,a,e[o+9],21,-343485551),a=f(a,s),n=f(n,l),i=f(i,d),r=f(r,p)}return Array(a,n,i,r)}function l(e,t,a,n,i,r){return f((r=f(f(t,e),f(n,r)))<<i|r>>>32-i,a)}function c(e,t,a,n,i,r,o){return l(t&a|~t&n,e,t,i,r,o)}function h(e,t,a,n,i,r,o){return l(t&n|a&~n,e,t,i,r,o)}function u(e,t,a,n,i,r,o){return l(t^a^n,e,t,i,r,o)}function m(e,t,a,n,i,r,o){return l(a^(t|~n),e,t,i,r,o)}function f(e,t){var a=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(a>>16)<<16|65535&a}Pharmit.hex_md5=e}(),function(i){i.support.cssPseudoClasses=function(){try{var e=i("<input type='checkbox' checked/>").appendTo("body"),t=i('<style type="text/css" />').appendTo("head");t.text("input:checked {width: 200px; display: none}");var a="200px"==e.css("width");return e.remove(),t.remove(),a}catch(e){return!1}}(),i.fn.fileinput=function(t){return t=t||'<button class="fileinput">Browse...</button>',this.each(function(){var e=i(this);e.wrap('<div class="fileinput-wrapper" style=" position: relative; display: inline-block;" />'),e.parent().mousemove(function(e){var t=i(this),a=t.offset().left,n=t.offset().top;t.find("input").css({left:e.pageX-a-t.find("input[type=file]").width()+30,top:e.pageY-n-10})}),e.attr("tabindex","-1").css({filter:"alpha(opacity=0)","-moz-opacity":0,opacity:0,position:"absolute","z-index":-1}),e.before(t),e.prev().addClass("fileinput"),i.support.cssPseudoClasses?(e.prev(".fileinput").click(function(){e.click()}),e.prev(":submit.fileinput").click(function(e){e.preventDefault()})):(e.css({"z-index":"auto",cursor:"pointer"}),e.prev(".fileinput").css("z-index",-1),e.removeAttr("tabindex"),e.prev(".fileinput").attr("tabindex","-1"),e.hover(function(){i(this).prev(".fileinput").addClass("hover")},function(){i(this).prev(".fileinput").removeClass("hover")}).focusin(function(){i(this).prev(".fileinput").addClass("focus")}).focusout(function(){i(this).prev(".fileinput").removeClass("focus")}).mousedown(function(){i(this).prev(".fileinput").addClass("active")}).mouseup(function(){i(this).prev(".fileinput").removeClass("active")}))}),this}}(jQuery),(Pharmit=Pharmit||{}).MinResults=function(n,i){function r(e){if(0===e.status)return{error:e.msg};for(var t=e.data,a=0;a<t.length;a++)t[a][3]=numeral(t[a][3]).format("0.00"),t[a][4]=numeral(t[a][4]).format("0.000"),t[a][2]=n.mangleName(t[a][2]);return t}function o(e,t){return e.cmd="getsminadata",e.qid=l,""!==h.val()&&(e.maxRMSD=h.val()),""!==a.val()&&(e.maxScore=a.val()),u.prop("checked")&&(e.unique=1),e}var s=null,l=null,d=null,p=null,c=null,a=null,h=null,u=null,m=0,f=null,b=null,g=null,v=this.cancel=function(){clearTimeout(f),$.fn.DataTable.isDataTable(c)&&0<l&&(c.DataTable().clear(),$.post(Pharmit.server,{cmd:"cancelsmina",qid:l})),l=null,i.setResult(),d.button("option","disabled",!0),s.hide()};this.minimize=function(e,t,a,n){p=n,l=e,b=t,25e3<(m=a)&&(alert("Results minimization is limited to 25000 compounds.  Your results will be truncated."),m=25e3);t={cmd:"startsmina",qid:l,receptorid:t.receptorid,recname:t.recname,num:m};$(".pharmit_mincontainer .pharmit_resbody").css({opacity:0}),$.post(Pharmit.server,t,null,"json").done(function(e){var t;e.status?(sminaid=e.sminaid,t=Math.floor((g.height()-100)/29),c.dataTable({searching:!1,pageLength:t,destroy:!0,lengthChange:!1,order:[[3,"asc"]],orderMulti:!1,columnDefs:[{targets:[0],visible:!1},{targets:[1],visible:!1},{targets:[2],className:"pharmit_minname",searchable:!1,sortable:!1},{targets:[3],className:"pharmit_minscore",searchable:!1},{targets:[4],className:"pharmit_minrmsd",searchable:!1}],language:{emptyTable:"Minimizing...",infoEmpty:" ",infoFiltered:"<br>(filtered from _MAX_ total hits)",info:"Minimizing..."},serverSide:!0,processing:!1,ajax:{url:Pharmit.server,data:o,dataSrc:r}}),c.show(),$(".pharmit_mincontainer .pharmit_resbody").css({opacity:100})):(v(),p&&p(),alert("Error: "+e.msg))}).fail(function(){v(),p&&p(),alert("Error contacting minimization server.  Please inform "+Pharmit.email+" if this problem persists.")}),s.show()};var s=$("<div>").appendTo(n.div).addClass("pharmit_rescontainer pharmit_mincontainer"),e=$("<div>").appendTo(s).addClass("pharmit_resheader"),t=$("<div>Minimization Results</div>").appendTo(e).addClass("pharmit_heading").addClass("pharmit_rightheading"),y=$("<div>").addClass("pharmit_resclose").appendTo(t).click(function(){v(),p&&p()}),g=($("<span>").addClass("ui-icon-circle-close ui-icon").appendTo(y),$("<div>").appendTo(s).addClass("pharmit_resbody")),c=$('<table width="100%" class="display compact" cellspacing="0">').addClass("pharmit_mintable").appendTo(g),w=$("<tr>").appendTo($("<thead>").appendTo(c));$("<th>mid</th>").appendTo(w),$("<th>origpos</th>").appendTo(w),$("<th>Name</th>").appendTo(w),$('<th title="Computed using the AutoDock Vina scoring function">Score</th>').appendTo(w),$('<th title="The minimized RMSD, the heavy atom difference between the pharmacophore aligned pose and the minimized pose.  Small values imply a closer agreement to the query pharmacophore.">mRMSD</th>').appendTo(w),$("<tbody>").appendTo(c),c.on("xhr.dt",function(e,t,a){var n=c.DataTable().settings()[0].oLanguage;a.finished?(ga("send","event","query","minimize",b.subset,a.recordsTotal),d.button("option","disabled",!1),d.one("click",function(){ga("send","event","save","minimized",b.subset,a.recordsTotal)}),n.sInfo="Showing _START_ to _END_ of _TOTAL_ entries"):0===a.status?alert(a.msg):(i.setResult(),n.sInfo=numeral(a.recordsTotal).format("0,0")+"/"+numeral(m).format("0,0"),clearTimeout(f),f=setTimeout(function(){$.fn.DataTable.isDataTable(c)&&0<l&&c.DataTable().ajax.reload()},1e3))}),c.on("draw.dt",function(){$(".pharmit_minname span").powerTip({mouseOnToPopup:!0,placement:"s",smartPlacement:!0})}),$("tbody",c).on("click","tr",function(){var n=c.DataTable().row(this).data()[0],t=this;$(".pharmit_iterate_button").remove(),$(this).hasClass("selected")?($(this).removeClass("selected"),i.setResult()):(c.DataTable().$("tr.selected").removeClass("selected"),$(this).addClass("selected"),$.post(Pharmit.server,{cmd:"getsminamol",qid:l,molid:n}).done(function(a){$(t).hasClass("selected")&&i.setResult(a);var e=$('<div class="pharmit_iterate_button" title="Start new pharmit session around selected ligand">').appendTo($("td",t).last());e.button({icons:{primary:"ui-icon-arrowthickstop-1-e"},text:!1}),e.tooltip({show:{delay:500}}),e.click(function(e){e.stopPropagation();var t=window.open("search.html"),e={ligand:a,ligandFormat:n+".sdf",receptor:b.receptor,recname:b.recname};new Message(JSON.stringify(e),t,"*")})}))}),e=$("<div>").appendTo(s).addClass("pharmit_resfooter"),t=$("<div>").appendTo(e).addClass("pharmit_minparams").disableSelection(),y=$("<table>").appendTo(t),w=$("<tr>").appendTo(y).addClass("pharmit_paramrow"),$("<td>").appendTo(w).append($("<label>Max Score</label>")),t=$("<td>").appendTo(w),a=$('<input name="sminamaxscore">').appendTo(t).addClass("pharmit_sminainput").spinner(),u=$('<input type="checkbox" name="sminaunique">'),$("<td>").appendTo(w).addClass("pharmit_checkcell").append(u),$("<td>").appendTo(w).append($("<label>Single<br>conformer</label>")),w=$("<tr>").appendTo(y).addClass("pharmit_paramrow"),$("<td>").appendTo(w).append($("<label>Max mRMSD</label>")),t=$("<td>").appendTo(w),h=$('<input name="sminamaxrmsd">').appendTo(t).addClass("pharmit_sminainput").spinner(),t=$("<td colspan=2>").appendTo(w).addClass("pharmit_applycell"),$("<button>Apply</button>").appendTo(t).button().click(function(){c.DataTable().ajax.reload()}),e=$("<div>").appendTo(e).addClass("pharmit_minbottom"),d=$("<button>Save...</button>").appendTo(e).button().click(function(){Pharmit.inFormSubmit=!0;var e=Pharmit.server+"?cmd=savesmina&qid="+l;""!==h.val()&&(e+="&maxRMSD="+h.val()),""!==a.val()&&(e+="&maxScore="+a.val()),u.prop("checked")&&(e+="&unique=1");var t=c.DataTable().order();e+="&order[0][column]="+t[0][0],e+="&order[0][dir]="+t[0][1];e=$("<form>",{action:e,method:"post"});e.appendTo(document.body),e.submit(),$(e).remove()}),s.hide();var T=0,_=0;$(window).resize(function(){var e,t;0<l&&((e=g.height())!=T&&(T=e,e-=$("thead",c).height(),e-=$(".dataTables_info",g).height(),e-=$(".dataTables_paginate",g).height(),e-=20,t=$("tr.odd",c).first().height()+1,(t=Math.floor(e/t))!=_&&(c.DataTable().page.len(t),c.DataTable().draw(),_=t)))})},(Pharmit=Pharmit||{}).Query=function(){var H="filter",N={name:"Hydrophobic",x:0,y:0,z:0,radius:1,enabled:!0,vector_on:0,minsize:"",maxsize:"",svector:null,hasvec:!1},E={name:"InclusionSphere",x:0,y:0,z:0,radius:1,enabled:!0,vector_on:0,minsize:"",maxsize:"",svector:null,hasvec:!1},j={name:"ExclusionSphere",x:0,y:0,z:0,radius:1,enabled:!0,vector_on:0,minsize:"",maxsize:"",svector:null,hasvec:!1},L=/@<TRIPOS>MOLECULE[^@]*?@<TRIPOS>ATOM\n(\s*\d+\s*(ACC|DON|CAT|ANI|HYD|AR).*)*\n@<TRIPOS>BOND\n/g,I=null,O=null;return function(e,g,t){function b(){var e=O(!0);"search"==H?(ga("send","event","query","shape",e.subset),t.shquery(e,c)):(ga("send","event","query","pharmacophore",e.subset),t.phquery(e,c))}function a(e,t){var a,n;0<e.files.length&&(a=e.files[0],(n=new FileReader).onload=function(e){t(e.target.result,a.name)},n.readAsText(a),$(e).val(""))}function s(e,a,n){var t=a.parent();a.detach();var i=a.children();$.each(i,function(e,t){t.feature.deleteFeature()}),a.empty(),e&&$.each(e,function(e,t){new Feature(g,a,t,n)}),a.accordion("option","active",!1),a.accordion("refresh"),t.prepend(a)}function i(e){if(e){(new Date).getTime();g.disableRendering();for(var t=[],a=[],n=[],i=0,r=e.length;i<r;i++){var o=e[i];("InclusionSphere"==o.name?a:"ExclusionSphere"==o.name?n:t).push(o)}s(t,d),s(a,v,Feature.INCLUSIVESHAPE),s(n,y,Feature.EXCLUSIVESHAPE),$("#exselect").change(),g.enableRendering();(new Date).getTime()}}function r(a,n){f=m=null;var e={cmd:"getpharma",ligand:a,ligandname:n};h&&(u?e.reckey=u:e.receptor=c,e.recname=h),$.post(Pharmit.server,e,null,"json").done(function(e){var t;e.status?(i(e.points),e.mol?(m=a,t="mol2",-1!==(f=n).indexOf(t,n.length-t.length)&&L.test(a)&&(a=a.replace(L,"")),g.setLigand(a,n)):g.setView()):alert("Error: "+e.msg)}).fail(function(e,t){"parsererror"==t?alert("Didn't understand the the server resonse.  If you can reproduce this error, please send your input files to "+Pharmit.email+"."):alert("Error contacting server.  Please inform "+Pharmit.email+" if this problem persists.")})}function o(e,t){var a;e&&t&&(c=e,h=t,g.setReceptor(e,t),u=null,a=Pharmit.hex_md5(c),$.post(Pharmit.server,{cmd:"setreceptor",key:a,receptor:c}).done(function(){u=a}))}var l=$("<div>").addClass("pharmit_query pharmit_overlay"),d=null,v=null,y=null,p=null,c=null,h=null,u=null,m=null,f=null;this.setLigandAndReceptor=function(e,t,a,n){a&&o(a,n),r(e,t)};var w=this.loadSession=function(e){var a=e;"string"==typeof e&&(a=$.parseJSON(e)),i(a.points),o(a.receptor,a.recname),g.setReceptor(c,h),f=a.sdf?(m=decodeURIComponent(a.sdf)).match(/^@<TRIPOS>MOLECULE/)?".mol2":m.match(/^HETATM/)||m.match(/^ATOM/)?".pdb":m.match(/^.*\n.*\n.\s*(\d+)\s+(\d+)/)?".sdf":".xyz":(m=a.ligand,a.ligandFormat),g.setLigand(m,f),$.each(a,function(e,t){var a=$("input[name="+e+"]");(a.length||(a=$("select[name="+e+"]")).length||(a=$("button[name="+e+"]")).length)&&a.val(t).change()}),$.each($(".ui-buttonset",l),function(e,t){t=t.id;a[t]&&(t="#"+a[t],$(t).prop("checked",!0).change())}),g.setView(a.view)};function T(e){return $("<div/>").text(e).html()}function _(t){var e=O(!0),e={cmd:"getmesh",type:t.meshstyle.kind,json:JSON.stringify(e)};null!==t.mesh&&t.meshtolerance==t.val()||$.post(Pharmit.server,e,null,"json").done(function(e){e.tolerance!=t.val()&&null!==t.mesh||(t.mesh&&g.removeMesh(t.mesh),t.mesh=g.addMesh(e,t.meshstyle),t.meshtolerance=e.tolerance)})}O=function(e){var i={points:[]};return $.each(d.children(),function(e,t){i.points.push(t.feature.obj)}),$.each(v.children(),function(e,t){i.points.push(t.feature.obj)}),$.each(y.children(),function(e,t){i.points.push(t.feature.obj)}),$.each($("[name]",l),function(e,t){var a,n=t.name;n&&(a=t.value,$.isNumeric(t.value)&&(a=Number(t.value)),i[n]=a)}),$.each($(".ui-buttonset",l),function(e,t){var a=t.id;a&&0<a.length&&(t=$(":checked",t).attr("id"),i[a]=t)}),i.ligand=m,i.ligandFormat=f,u&&e||(i.receptor=c),i.recname=h,i.receptorid=u,i.view=g.getView(),i};var C=$("<div>").appendTo(l).addClass("pharmit_leftclose"),x=$("<span>").addClass("ui-icon ui-icon-carat-1-w").appendTo(C);l.resizable({handles:"e",resize:function(e,t){g.setLeft(t.size.width)}}),l.disableSelection(),C.click(function(){var e,t;C.hasClass("pharmit_leftisclosed")?(C.removeClass("pharmit_leftisclosed"),x.removeClass("ui-icon-carat-1-e"),x.addClass("ui-icon-carat-1-w"),e=l.width(),l.css("width",""),t=l.width(),l.width(e),l.animate({width:t},{progress:function(){g.setLeft(l.width())}}),l.resizable("option","disabled",!1)):(l.animate({width:0},{progress:function(){g.setLeft(l.width())}}),C.addClass("pharmit_leftisclosed"),x.addClass("ui-icon-carat-1-e"),x.removeClass("ui-icon-carat-1-w"),l.resizable("option","disabled",!0))});var S=$("<div>").appendTo(l).addClass("pharmit_queryheader"),k=$("<div>").appendTo(S).addClass("pharmit_loaderdiv").addClass("pharmit_nowrap"),P=$("<button>Load Receptor...</button>").button(),M=$('<button title="Pharmacophore features can be provided as pharmacophore query formats (MOE, LigBuilder, LigandScout, PharmaGist, Pharmer) or automatically extracted from ligand structures (sdf, pdf, mol2, xyz). If a receptor is loaded, only interacting features will be enabled.">Load Features...</button>').button();e.append(l),$('<input type="file">').appendTo(k).fileinput(P).change(function(e){a(this,o)}),$('<input type="file">').appendTo(k).fileinput(M).change(function(e){a(this,r)}),l.detach();var F=$("<div>").appendTo(l).addClass("pharmit_querybody"),p=($("<div>Pharmacophore</div>").appendTo(F).addClass("pharmit_heading"),$("<div>").appendTo(F));(d=$("<div>").appendTo(p)).accordion({header:"> div > h3",animate:!0,active:!1,collapsible:!0,heightStyle:"content",beforeActivate:function(e,t){var a=d.children();$.each(a,function(e,t){t.feature.deselectFeature()}),0<t.newHeader.length&&t.newHeader.parent().get(0).feature.selectFeature()}}).sortable({axis:"y",handle:"h3",stop:function(e,t){t.item.children("h3").triggerHandler("focusout"),$(this).accordion("refresh")}});var R,p=$("<div>").appendTo(p).addClass("pharmit_featurebuttons");$("<button>Add</button>").appendTo(p).button({text:!0,icons:{secondary:"ui-icon-circle-plus"}}).click(function(){new Feature(g,d,N)}),$("<button>Sort</button>").appendTo(p).button({text:!0,icons:{secondary:"ui-icon ui-icon-carat-2-n-s"}}).click(function(){var e=d.children().detach();e.sort(function(e,t){e=e.feature.obj,t=t.feature.obj;return e.enabled!=t.enabled?t.enabled-e.enabled:e.name!=t.name?e.name.localeCompare(t.name):e.radius-t.radius}),d.append(e)}),function(e){var t=$("<div>").appendTo(e);$("<div>Shape</div>").appendTo(t).addClass("pharmit_heading");var a=$("<div>").appendTo(t).addClass("pharmit_shapeconstraints"),n=($('<h3 id="inshapehead">Inclusive Shape<br></h3>').appendTo(a),$('<div id="pharmit_inclusiveshape">').appendTo(a)),e=$("<div>").appendTo(n),i=$('<select name="inselect" id="inselect">').addClass("pharmit_shapeselector").appendTo(e);$('<option value="none">None</option>').appendTo(i),$('<option value="ligand">Ligand</option>').appendTo(i),$('<option value="points">Spheres</option>').appendTo(i),i.val("none"),i.selectmenu({width:"14em",appendTo:e,change:function(){i.change()},position:{my:"left top",at:"left bottom",collision:"flip"}});var r=$('<div id="none-indiv">').appendTo(n);$("<div>No inclusive shape will be used to filter pharmacophore matches.</div>").appendTo(r).addClass("pharmit_shapedesc pharmit_shapefiltertext"),$("<div>No inclusive shape will be used for shape screening.</div>").appendTo(r).addClass("pharmit_shapedesc pharmit_shapesearchtext");var o=$('<div id="ligand-indiv">').appendTo(n);$("<div>At least one heavy atom in a pharmacophore aligned pose must fall within the inclusive shape.</div>").appendTo(o).addClass("pharmit_shapedesc pharmit_shapefiltertext"),$("<div>The entirety of the inclusive shape must be contained within the aligned hit.</div>").appendTo(o).addClass("pharmit_shapedesc pharmit_shapesearchtext");t=$("<table>").appendTo(o),e=$("<tr>").appendTo(t);$("<td>").append('<label title="Depth in Angstroms to reduce surface of ligand inclusive shape by." value = "1" for="intolerance">Tolerance:</label>').appendTo(e);var s=$("<td>").appendTo(e).addClass("pharmit_shapecell"),l=$('<input id="intolerance" name="intolerance">').appendTo(s);l.mesh=null,l.meshstyle={kind:"inclusive"},l.change(function(){_(l)}),l.spinner({step:.5,stop:function(){l.change()}}),l.val(1);var d=$('<div id="inshapestyle">').appendTo(o).addClass("pharmit_meshstylediv");$('<input type="radio" id="inshapestyle-hide" name="inshapestyle"><label for="inshapestyle-hide">Hide</label>').appendTo(d).change(function(){$(this).prop("checked")&&(l.meshstyle.hidden=!0,g.updateMesh(l.mesh,l.meshstyle)),d.buttonset("refresh")}),$('<input type="radio" id="inshapestyle-wire" name="inshapestyle"><label for="inshapestyle-wire">Wire</label>').appendTo(d).change(function(){$(this).prop("checked")&&(l.meshstyle.hidden=!1,l.meshstyle.wireframe=!0,g.updateMesh(l.mesh,l.meshstyle)),d.buttonset("refresh")}),$('<input type="radio" id="inshapestyle-solid" name="inshapestyle"><label for="inshapestyle-solid">Solid</label>').appendTo(d).change(function(){$(this).prop("checked")&&(l.meshstyle.hidden=!1,l.meshstyle.wireframe=!1,g.updateMesh(l.mesh,l.meshstyle)),d.buttonset("refresh")}).prop("checked",!0),d.buttonset();var p=$('<div id="points-indiv">').appendTo(n);$("<div>At least one heavy atom center of a pharmacophore aligned pose must fall within <b>each</b> sphere.</div>").appendTo(p).addClass("pharmit_shapedesc pharmit_shapefiltertext"),$("<div>The entirety of the interaction point shapes must be contained within the aligned hit.</div>").appendTo(p).addClass("pharmit_shapedesc pharmit_shapesearchtext"),(v=$("<div>").appendTo(p)).accordion({header:"> div > h3",animate:!0,active:!1,collapsible:!0,heightStyle:"content",beforeActivate:function(e,t){var a=v.children();$.each(a,function(e,t){t.feature.deselectFeature()}),0<t.newHeader.length&&t.newHeader.parent().get(0).feature.selectFeature()}}).sortable({axis:"y",handle:"h3",stop:function(e,t){t.item.children("h3").triggerHandler("focusout"),$(this).accordion("refresh")}});t=$('<div class="pharmit_pointsbuttons">').appendTo(p),$("<button>Add</button>").appendTo(t).button({text:!0,icons:{secondary:"ui-icon-circle-plus"}}).click(function(){new Feature(g,v,E,Feature.INCLUSIVESHAPE)});i.change(function(){r.hide(),o.hide(),p.hide(),"ligand"==this.value?($.each(v.children(),function(e,t){t.feature.hideFeature()}),o.show(),$("#inshapehead").addClass("pharmit_oblique"),l.change()):("points"==this.value?($.each(v.children(),function(e,t){t.feature.unhideFeature()}),$("#inshapehead").addClass("pharmit_oblique"),p.show()):($.each(v.children(),function(e,t){t.feature.hideFeature()}),$("#inshapehead").removeClass("pharmit_oblique"),r.show()),l.mesh&&g.removeMesh(l.mesh),l.mesh=null),i.selectmenu("refresh")}),i.change();$('<h3 id="exshapehead">Exclusive Shape<br></h3>').appendTo(a);var e=$('<div id="pharmit_exclusiveshape">').appendTo(a),n=$("<div>").appendTo(e),c=$('<select name="exselect" id="exselect">').addClass("pharmit_shapeselector").appendTo(n);$('<option value="none">None</option>').appendTo(c),$('<option value="receptor">Receptor</option>').appendTo(c),$('<option value="points">Spheres</option>').appendTo(c),c.val("none"),c.selectmenu({width:"11em",appendTo:n,change:function(){c.change()},position:{my:"left top",at:"left bottom",collision:"flip"}});var h=$('<div id="none-exdiv">').appendTo(e);$("<div>No exclusive shape constraint will be applied.</div>").appendTo(h).addClass("pharmit_shapedesc");var u=$('<div id="receptor-exdiv">').appendTo(e);$("<div>").appendTo(u).addClass("pharmit_shapedesc pharmit_shapefiltertext").text("Hits that have heavy atom centers within the exclusive shape in their pharmacophore aligned pose will be filtered out."),$("<div>").appendTo(u).addClass("pharmit_shapedesc pharmit_shapesearchtext").text("Aligned hits may not overlap any portion of the exclusive shape.");n=$("<table>").appendTo(u),n=$("<tr>").appendTo(n);$("<td>").append('<label title="Depth in Angstroms to reduce surface of receptor exclusive shape by." value = "1" for="extolerance">Tolerance:</label>').appendTo(n),s=$("<td>").appendTo(n).addClass("pharmit_shapecell");var m=$('<input id="extolerance" name="extolerance">').appendTo(s).val(1);m.mesh=null,m.meshstyle={kind:"exclusive"},m.change(function(){_(m)}),m.spinner({step:.5,stop:function(){m.change()}});var f=$('<div id="exshapestyle">').appendTo(u).addClass("pharmit_meshstylediv");$('<input type="radio" id="exshapestyle-hide" name="exshapestyle"><label for="exshapestyle-hide">Hide</label>').appendTo(f).change(function(){$(this).prop("checked")&&(m.meshstyle.hidden=!0,g.updateMesh(m.mesh,m.meshstyle)),f.buttonset("refresh")}),$('<input type="radio" id="exshapestyle-wire" name="exshapestyle"><label for="exshapestyle-wire">Wire</label>').appendTo(f).change(function(){$(this).prop("checked")&&(m.meshstyle.hidden=!1,m.meshstyle.wireframe=!0,g.updateMesh(m.mesh,m.meshstyle)),f.buttonset("refresh")}),$('<input type="radio" id="exshapestyle-solid" name="exshapestyle"><label for="exshapestyle-solid">Solid</label>').appendTo(f).change(function(){$(this).prop("checked")&&(m.meshstyle.hidden=!1,m.meshstyle.wireframe=!1,g.updateMesh(m.mesh,m.meshstyle)),f.buttonset("refresh")}).prop("checked",!0),f.buttonset();var b=$('<div id="points-exdiv">').appendTo(e);$("<div>Heavy atom centers of pharmacophore aligned poses may not fall within any exclusion sphere.</div>").appendTo(b).addClass("pharmit_shapedesc pharmit_shapefiltertext"),$("<div>Aligned hits may not overlap any exclusion sphere.</div>").appendTo(b).addClass("pharmit_shapedesc pharmit_shapesearchtext"),(y=$("<div>").appendTo(b)).accordion({header:"> div > h3",animate:!0,active:!1,collapsible:!0,heightStyle:"content",beforeActivate:function(e,t){var a=y.children();$.each(a,function(e,t){t.feature.deselectFeature()}),0<t.newHeader.length&&t.newHeader.parent().get(0).feature.selectFeature()}}).sortable({axis:"y",handle:"h3",stop:function(e,t){t.item.children("h3").triggerHandler("focusout"),$(this).accordion("refresh")}}),t=$('<div class="pharmit_pointsbuttons">').appendTo(b),$("<button>Add</button>").appendTo(t).button({text:!0,icons:{secondary:"ui-icon-circle-plus"}}).click(function(){new Feature(g,y,j,Feature.EXCLUSIVESHAPE)}),c.change(function(){"receptor"==this.value?($.each(y.children(),function(e,t){t.feature.hideFeature()}),h.hide(),b.hide(),u.show(),m.change(),$("#exshapehead").addClass("pharmit_oblique")):("points"==this.value?($.each(y.children(),function(e,t){t.feature.unhideFeature()}),h.hide(),u.hide(),b.show(),$("#exshapehead").addClass("pharmit_oblique")):($.each(y.children(),function(e,t){t.feature.hideFeature()}),$("#exshapehead").removeClass("pharmit_oblique"),h.show(),b.hide(),u.hide()),m.mesh&&g.removeMesh(m.mesh),m.mesh=null),c.selectmenu("refresh")}),c.change(),a.accordion({animate:!0,active:!1,collapsible:!0,heightStyle:"content"})}(F),function(e){var t=$("<div>").appendTo(e);$("<div>Filters</div>").appendTo(t).addClass("pharmit_heading");var a=$("<div>").appendTo(t),n=$("<h3>Hit Reduction<br></h3>").appendTo(a),i=$("<div>").addClass("pharmit_hitreduction").appendTo(a),r=$("<table>").appendTo(i),e=function(){""!==$("#reduceorienttext").val()||""!==$("#reduceconfstext").val()||""!==$("#reducehitstext").val()?n.addClass("pharmit_filtermodified"):n.removeClass("pharmit_filtermodified")},t=$("<tr>").addClass("pharmit_filterrow").appendTo(r);$("<td>").append('<label title="Maximum number of orientations returned for each conformation" value="1" for="reduceorienttext">Max Hits per Conf:</label>').appendTo(t);i=$("<td>").appendTo(t);$('<input id="reduceorienttext" name="max-orient">').appendTo(i).spinner({min:0,stop:e}).change(e),t=$("<tr>").addClass("pharmit_filterrow").appendTo(r),$("<td>").append('<label title="Maximum number of conformations returned for each compound" value="1" for="reduceconfstext">Max Hits per Mol:</label>').appendTo(t),i=$("<td>").appendTo(t),$('<input id="reduceconfstext" name="reduceConfs">').appendTo(i).spinner({min:0,stop:e}).change(e),t=$("<tr>").addClass("pharmit_filterrow").appendTo(r),$("<td>").append('<label title="Maximum number of hits returned" value="1" for="reducehitstext">Max Total Hits:</label>').appendTo(t),i=$("<td>").appendTo(t),$('<input id="reducehitstext" name="max-hits">').appendTo(i).spinner({min:0,stop:e}).change(e);function o(){var a=!0;$("[name]",l).each(function(e,t){""!==t.value&&(a=!1)}),a?s.removeClass("pharmit_filtermodified"):s.addClass("pharmit_filtermodified")}var s=$("<h3>Hit Screening<br></h3>").appendTo(a),l=$("<div>").appendTo(a).addClass("pharmit_hitscreening"),d=$("<table>").appendTo(l),e=function(e,t,a,n){var i=$("<tr>").addClass("pharmit_filterrow").appendTo(d),r=$("<td>").appendTo(i);$('<input name="min'+e+'">').appendTo(r).spinner({min:n,stop:o}).change(o),$("<td>").appendTo(i).append($('<label title="'+a+'" value="1" >&le;  '+t+" &le;</label>")),r=$("<td>").appendTo(i),$('<input name="max'+e+'">').appendTo(r).spinner({min:n,stop:o}).change(o)};e("MolWeight","MolWeight","Minimum/maximum molecular weight (weights are approximate)",0),e("rotbonds","RotBonds","Minimum/maximum number of rotatable bonds",0),e("logp","LogP","Minimum/maximum partition coefficient as calculated by OpenBabel"),e("psa","PSA","Minimum/maximum polar surface area as calculated by OpenBabel"),e("aromatics","Aromatics","Minimum/maximum number of smallest aromatic rings",0),e("hba","HBA","Minimum/maximum number of hydrogen bond acceptors",0),e("hbd","HBD","Minimum/maximum number of hydrogen bond donors",0),a.accordion({animate:!0,active:!1,collapsible:!0,heightStyle:"content"})}(F),k=S,M="ShapeModeSelect",k=$("<div>").prependTo(k).addClass("pharmit_shapemodediv"),R=$('<button name="'+M+'" id="'+M+' value="filter">Pharmacophore Search -&gt; Shape Filter</button>').addClass("pharmit_styleselector").appendTo(k),H="filter",R.button(),R.change(function(){"search"==(H=this.value)?(R.button("option","label","Shape Search -&gt; Pharmacophore Filter"),$(".pharmit_shapefiltertext").hide(),$(".pharmit_shapesearchtext").show()):(H="filter",R.button("option","label","Pharmacophore Search -&gt; Shape Filter"),$(".pharmit_shapefiltertext").show(),$(".pharmit_shapesearchtext").hide()),R.button("refresh")}),R.val("filter"),R.change(),R.click(function(){"filter"==this.value?this.value="search":this.value="filter",R.change()});var p=$("<div>").addClass("pharmit_searchdiv"),A=$('<button id="pharmitsearchbutton" name="subset">Search</button>').appendTo(p).button(),z=$("<button>Select subset to search</button>").appendTo(p).button({text:!1,icons:{primary:"ui-icon-triangle-1-s"}});function D(e,t){var i=t.standard,a=A.val();""==a&&(a="molport");var r=!1,o=0;for(n=i.length;o<n;o++)if(a==i[o].subdir){r=!0;break}r||(a=i[0].subdir);var o,s=$("<ul>").appendTo($("body")).addClass("pharmit_floatmenu"),l=[];for(o=0,n=i.length;o<n;o++)c=i[o],d=T(c.name),c.html&&(d=c.html),l[o]="<li value="+o+' class="pharmit_subsetmenu">'+d+"<br>",l[o]+='<span class="pharmit_subsetcnts">'+numeral(c.numConfs).format("0,0")+" conformers of "+numeral(c.numMols).format("0,0")+" molecules</span>",l[o]+='<span class="pharmit_subsettime">Updated: '+c.updated+"</span>",l[o]+="</li>",c.subdir==a&&(A.button("option","label","Search "+c.name),A.val(c.subdir));s.append(l),s.append($("<li> </li>"));var d,p,c,h=$('<li class="pharmit_contributed">Contributed Libraries</li>'),h=$("<ul>").appendTo(h).addClass("pharmit_contributed_menu"),u=[],m=[],f=t.public;for(o=0,n=f.length;o<n;o++)0!==(c=f[o]).numConfs&&(d=T(c.name),p="",m[o]=d+c.updated,c.description&&(p=" title='"+T(c.description)+"' ",m[o]+=" "+T(c.description)),m[o]=m[o].toLowerCase(),u[o]="<li value="+i.length+p+' class="pharmit_subsetmenu">'+d+"<br>",i.push(c),u[o]+='<span class="pharmit_contrib_subsettime">Created: '+c.updated+"</span>",u[o]+='<span class="pharmit_contrib_subsetcnts">'+numeral(c.numConfs).format("0,0")+" conformers of "+numeral(c.numMols).format("0,0")+" molecules</span>",u[o]+="</li>",u[o]=$(u[o]));h.append(u),publicdialog=$('<div class="pharmit_public_dialog" title="Contributed Libraries"> </div>'),publicsearch=$('<input type="text" id="input" class="pharmit_contrib_search">'),$('<div class="pharmit_search_div"><b>Search: </b></div>').append(publicsearch).appendTo(publicdialog),publicsearch.keyup(function(){var e=publicsearch.val().toLowerCase();for(o in u)-1<m[o].indexOf(e)?u[o].css("display",""):u[o].css("display","none")}),publicdialog.append(h),publicdialog.appendTo(F),publicdialog.dialog({autoOpen:!1,height:525,width:600,modal:!0}),$('<li class="pharmit_private">Contributed Libraries...</li>').appendTo(s).click(function(){publicdialog.dialog("open")}),s.append($("<li> </li>")),$('<li class="pharmit_private">Access Private Library...</li>').appendTo(s).click(function(){I.dialog("open")}),h.menu({position:{my:"left top",at:"right top",collision:"fit"}}).on("menuselect",function(e,t){t=i[t.item.val()];A.button("option","label","Search "+t.name),A.val(t.subdir),publicdialog.dialog("close")}),s.hide().menu({position:{my:"left top",at:"right top",collision:"fit"}}).on("menuselect",function(e,t){t=i[t.item.val()];A.button("option","label","Search "+t.name),A.val(t.subdir)}),A.click(b),A.change(function(){for(var e=A.val(),t=0,a=i.length;t<a;t++)if((c=i[t]).subdir==e){A.button("option","label","Search "+c.name);break}t==a&&A.button("option","label","Unknown Subset")}),z.click(function(){var e=s.show().position({my:"left top",at:"left bottom",of:this,collision:"flipfit"});return $(document).one("click",function(){e.hide()}),!1})}z.tooltip().tooltip("disable"),A.val(""),p.buttonset(),$.post(Pharmit.server,{cmd:"getsubsets"},null,"json").done(function(e){D(0,e)}).fail(function(){D(0,{standard:[{name:"Error"}],public:[]}),alert("Error contacting server.  Please inform "+Pharmit.email+" if this problem persists.")}),S.prepend(p),p=$("<div>").appendTo(F),$("<div>Visualization</div>").appendTo(p).addClass("pharmit_heading"),p=$("<div>").appendTo(p).addClass("pharmit_vizdiv"),g.appendViewerControls(p),p=$("<div>").appendTo(l).addClass("pharmit_queryfooter"),p=$("<div>").appendTo(p).addClass("pharmit_bottomloaders").addClass("pharmit_nowrap"),e.append(l),e=$("<button>Load Session...</button>").button(),$('<input type="file">').appendTo(p).fileinput(e).change(function(){a(this,w)}),$("<button>Save Session...</button>").appendTo(p).button().click(function(){Pharmit.inFormSubmit=!0;var e=Pharmit.server+'?cmd=savedata&type="text%2Fphjson"&fname="pharmit.json"',t=$("<form>",{action:e,method:"post"}),e=O(!1);t.append($("<input>",{name:"data",type:"hidden",value:JSON.stringify(e,null,4)})),t.appendTo(document.body),t.submit(),$(t).remove()}),g.setLeft(l.width()),I=$('<div class="pharmit_private_dialog" title="Access Private Library">Enter your access code: </div>').appendTo(F),$('<input type="text" id="privateid" class="pharmit_privatetext">').appendTo(I),I.dialog({autoOpen:!1,height:125,width:400,modal:!0,buttons:{Submit:function(){$.post(Pharmit.server,{cmd:"getsubsets",subset:"Private/"+$("#privateid").val()},null,"json").done(function(e){var t;e.error?alert(e.error):((t=$("#pharmitsearchbutton")).button("option","label","Search "+e.name),t.val(e.subdir))}).fail(function(){alert("Error contacting server.  Please inform "+Pharmit.email+" if this problem persists.")}),I.dialog("close")},Cancel:function(){I.dialog("close")}}})}}(),(Pharmit=Pharmit||{}).Results=function(e,a){var n=this.div=$("<div>").addClass("pharmit_results pharmit_overlay").appendTo(e),i=null,r=null,e=null;this.phquery=function(e,t){i.cancel(),r.cancel(),r.hide(),i.query(e,t),this.show()},this.shquery=function(e,t){r.cancel(),i.cancel(),i.hide(),r.query(e,t),this.show()},this.show=function(){n.show(),a.setRight(n.width())},this.close=function(){n.hide(),a.setRight(0)},this.mangleName=function(e){for(var t,a=e.split(" "),n="",i=0;i<a.length;i++){var r=a[i],o=(t=void 0,t=null,(t=(o=r).match(/PubChem-?(\d+)/))?"https://pubchem.ncbi.nlm.nih.gov/compound/"+t[1]:(t=o.match(/MolPort-?(\S+)/))?"https://www.molport.com/shop/moleculelink/about-this-molecule/"+t[1].replace(/-/g,""):(t=o.match(/^CHEMBL/))?"https://www.ebi.ac.uk/chembldb/index.php/compound/inspect/"+o:(t=o.match(/ChemDiv-?(\S+)/))?"http://chemistryondemand.com:8080/eShop/search_results.jsp?idnumber="+t[1]:(t=o.match(/ZINC(\d+)/))?"http://zinc15.docking.org/substances/"+t[1]:(t=o.match(/CSC(\d+)/))?"https://chem-space.com/"+o:(t=o.match(/^MCULE-/))?"https://mcule.com/"+o:(t=o.match(/(\S+-N)$/))?"https://ultimateapp.mcule.com/search/?t=exact&q="+o:null);n+=o?"<a target='_blank' href='"+o+"'>"+r+"</a><br>":r+"<br>"}return'<span data-powertip="'+n+'">'+a[0]+"</span>"};var o=$("<div>").appendTo(n).addClass("pharmit_rightclose"),s=$("<span>").addClass("ui-icon ui-icon-carat-1-e").appendTo(o);n.resizable({handles:"w",resize:function(e,t){a.setRight(t.size.width),$(this).css("left","")}}),n.disableSelection(),o.click(function(){var e,t;o.hasClass("pharmit_rightisclosed")?(o.removeClass("pharmit_rightisclosed"),s.removeClass("ui-icon-carat-1-w"),s.addClass("ui-icon-carat-1-e"),e=n.width(),n.css("width",""),t=n.width(),n.width(e),n.animate({width:t},{progress:function(){a.setRight(n.width())}}),n.resizable("option","disabled",!1)):(n.animate({width:0},{progress:function(){a.setRight(n.width())}}),o.addClass("pharmit_rightisclosed"),s.addClass("ui-icon-carat-1-w"),s.removeClass("ui-icon-carat-1-e"),n.resizable("option","disabled",!0))}),e=new Pharmit.MinResults(this,a),(i=new Pharmit.SearchResults(this,a,e)).hide(),(r=new Pharmit.SearchResults(this,a,e,"shape")).hide(),n.hide(),n.is(":visible")&&a.setRight(n.width()),$(window).on("beforeunload",function(){Pharmit.inFormSubmit?Pharmit.inFormSubmit=!1:i.cancel()})},(Pharmit=Pharmit||{}).SearchResults=function(e,r,a,n){function i(e){if(0===e.status)return{error:e.msg};for(var t=e.data,a=0;a<t.length;a++)t[a][1]=numeral(t[a][1]).format("0.000"),t[a][0]=m.mangleName(t[a][0]);return t}var o=null,s=null,l=null,d=null,p=null,c=null,h=null,u=null,m=e,f=null,b=null,g=new Date,v=0,y=0;$.fn.DataTable.ext.pager.numbers_length=5,this.query=function(e,t){l=$.extend({},e),f=t;t={cmd:"startquery",json:JSON.stringify(l)};null!==s&&(t.oldqid=s),g=new Date,$.post(Pharmit.server,t,null,"json").done(function(e){var t;e.status?(s=e.qid,t=Math.floor((p.height()-120)/28),d.dataTable({searching:!1,pageLength:t,destroy:!0,lengthChange:!1,order:"shape"==n?[[1,"desc"]]:[[1,"asc"]],orderMulti:!1,columnDefs:[{targets:[0],className:"pharmit_namecol",searchable:!1,sortable:!1},{targets:[1],className:"pharmit_rmsdcol",searchable:!1},{targets:[2],className:"pharmit_masscol",searchable:!1},{targets:[3],className:"pharmit_bondscol",searchable:!1},{targets:[4],visible:!1}],language:{emptyTable:"<span class='pharmit_pulse'>Searching "+numeral(e.numMols).format("0,0")+" molecules and "+numeral(e.numConfs).format("0,0")+" conformers...</span>",infoFiltered:"",infoEmpty:"",info:"<span class='pharmit_pulse'>Searching...</span>"},serverSide:!0,processing:!1,ajax:{url:Pharmit.server,data:{cmd:"getdata",qid:s},dataSrc:i}})):(b(),m.close(),alert("Error: "+e.msg))}).fail(function(){b(),m.close(),alert("Error contacting server.  Please inform "+Pharmit.email+" if this problem persists.")}),o.show()},this.hide=function(){o.hide()},this.show=function(){o.show(),d.DataTable().ajax.reload()};var b=this.cancel=function(){a.cancel(),clearTimeout(u),null!==s&&$.post(Pharmit.server,{cmd:"cancelquery",oldqid:s}),$.fn.DataTable.isDataTable(d)&&d.DataTable().clear(),s=null,c.button("option","disabled",!0),h.button("option","disabled",!0)},o=$("<div>").appendTo(m.div).addClass("pharmit_rescontainer"),t=$("<div>").appendTo(o).addClass("pharmit_resheader"),e="shape"==n?"Aligned Shape Results":"Pharmacophore Results";t=$("<div>"+e+"</div>").appendTo(t).addClass("pharmit_heading").addClass("pharmit_rightheading"),t=$("<div>").addClass("pharmit_resclose").appendTo(t).click(function(){b(),m.close()}),$("<span>").addClass("ui-icon-circle-close ui-icon").appendTo(t),p=$("<div>").appendTo(o).addClass("pharmit_resbody"),d=$('<table width="100%" class="display compact" cellspacing="0">').addClass("pharmit_phtable").appendTo(p),t=$("<tr>").appendTo($("<thead>").appendTo(d)),$("<th>Name</th>").appendTo(t),("shape"==n?$("<th>Sim</th>"):$("<th>RMSD</th>")).appendTo(t),$("<th>Mass</th>").appendTo(t),$("<th>RBnds</th>").appendTo(t),$("<th>mid</th>").appendTo(t),$("<tbody>").appendTo(d),d.on("xhr.dt",function(e,t,a){var n,i;a.finished?(n=d.DataTable().settings()[0].oLanguage,i=(new Date-g)/1e3,0===a.recordsTotal?n.emptyTable=n.sEmptyTable="No results found":(n.sInfo="<span title='Query took "+i+" seconds'>Showing _START_ to _END_ of _TOTAL_ hits",a.benchmark&&(n.sInfo+=". EF: "+numeral(a.benchmark.EF).format("0.0"),n.sInfo+=", F1: "+numeral(a.benchmark.F1).format("0.00")),n.sInfo+="</span>",c.button("option","disabled",!1),h.button("option","disabled",!1),h.one("click",function(){ga("send","event","save","pharmacophore",l.subset,a.recordsTotal)}))):0===a.status||(r.setResult(),clearTimeout(u),u=setTimeout(function(){0<s&&d.DataTable().ajax.reload()},1e3))}),d.on("draw.dt",function(){$(".pharmit_namecol span").powerTip({mouseOnToPopup:!0,placement:"s",smartPlacement:!0})}),$("tbody",d).on("click","tr",function(){var t=this,n=d.DataTable().row(t).data()[4];$(".pharmit_iterate_button").remove(),$(t).hasClass("selected")?($(t).removeClass("selected"),r.setResult()):(d.DataTable().$("tr.selected").removeClass("selected"),$(t).addClass("selected"),$.post(Pharmit.server,{cmd:"getmol",qid:s,loc:n}).done(function(a){var e;$(t).hasClass("selected")&&(r.setResult(a),(e=$('<div class="pharmit_iterate_button" title="Start new pharmit session around selected ligand">').appendTo($("td",t).last())).button({icons:{primary:"ui-icon-arrowthickstop-1-e"},text:!1}),e.tooltip({show:{delay:500}}),e.click(function(e){e.stopPropagation();var t=window.open("search.html"),e={ligand:a,ligandFormat:n+".sdf",receptor:f,recname:l.recname};new Message(JSON.stringify(e),t,"*")}))}))}),t=$("<div>").appendTo(o).addClass("pharmit_resfooter"),t=$("<div>").appendTo(t).addClass("pharmit_bottomloaders").addClass("pharmit_nowrap"),c=$("<button>Minimize</button>").appendTo(t).button({disabled:!0}).click(function(){o.hide();var e=d.DataTable().ajax.json().recordsTotal,t=$.extend({},l);t.receptor=f,a.minimize(s,t,e,function(){o.show(),d.DataTable().ajax.reload()})}),h=$("<button>Save...</button>").appendTo(t).button({disabled:!0}).click(function(){var e=Pharmit.server+"?cmd=saveres&qid="+s,e=$("<form>",{action:e,method:"post"});e.appendTo(document.body),Pharmit.inFormSubmit=!0,e.submit(),$(e).remove()}),$(window).resize(function(){var e,t;0<s&&((e=p.height())!=v&&(v=e,e-=$("thead",d).height(),e-=$(".dataTables_info",p).height(),e-=$(".dataTables_paginate",p).height(),e-=24,t=$("tr.odd",d).first().height()+1,(t=Math.floor(e/t))!=y&&(d.DataTable().page.len(t),d.DataTable().draw(),y=t)))})},function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports&&"object"==typeof module?module.exports=e:e(jQuery)}(function(Fe,Re){"use strict";var e,Ae={beforeShow:a,move:a,change:a,show:a,hide:a,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!1,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},ze=[],De=!!/msie/i.exec(window.navigator.userAgent),He=((e=document.createElement("div").style).cssText="background-color:rgba(0,0,0,.5)",t(e.backgroundColor,"rgba")||t(e.backgroundColor,"hsla")),Ne="color"===(e=Fe("<input type='color' value='!' />")[0]).type&&"!"!==e.value,Ee=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),je=function(){var e="";if(De)for(var t=1;t<=6;t++)e+="<div class='sp-"+t+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",e,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}();function t(e,t){return!!~(""+e).indexOf(t)}function Le(e,t,a,n){for(var i=[],r=0;r<e.length;r++){var o,s,l,d=e[r];d?(s=(o=tinycolor(d)).toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light",s+=tinycolor.equals(t,d)?" sp-thumb-active":"",l=o.toString(n.preferredFormat||"rgb"),d=He?"background-color:"+o.toRgbString():"filter:"+o.toFilter(),i.push('<span title="'+l+'" data-color="'+o.toRgbString()+'" class="'+s+'"><span class="sp-thumb-inner" style="'+d+';" /></span>')):i.push(Fe("<div />").append(Fe('<span data-color="" style="background-color:transparent;" class="sp-clear-display"></span>').attr("title",n.noColorSelectedText)).html())}return"<div class='sp-cf "+a+"'>"+i.join("")+"</div>"}function r(e,t){var a,n,i,r,o,s=(o=t,t=e,(o=Fe.extend({},Ae,o)).callbacks={move:Oe(o.move,t),change:Oe(o.change,t),show:Oe(o.show,t),hide:Oe(o.hide,t),beforeShow:Oe(o.beforeShow,t)},o),l=s.flat,d=s.showSelectionPalette,p=s.localStorageKey,o=s.theme,c=s.callbacks,h=(a=Pe,function(){var e=this,t=arguments;i&&clearTimeout(r),!i&&r||(r=setTimeout(function(){r=null,a.apply(e,t)},n))}),u=!(n=10),m=0,f=0,b=0,g=0,v=0,y=0,$=0,w=0,T=0,_=0,C=1,x=[],S=[],k={},P=s.selectionPalette.slice(0),M=s.maxSelectionSize,F="sp-dragging",R=null,A=e.ownerDocument,z=(A.body,Fe(e)),D=!1,H=Fe(je,A).addClass(o),N=H.find(".sp-picker-container"),E=H.find(".sp-color"),j=H.find(".sp-dragger"),L=H.find(".sp-hue"),I=H.find(".sp-slider"),O=H.find(".sp-alpha-inner"),q=H.find(".sp-alpha"),V=H.find(".sp-alpha-handle"),B=H.find(".sp-input"),U=H.find(".sp-palette"),W=H.find(".sp-initial"),X=H.find(".sp-cancel"),J=H.find(".sp-clear"),G=H.find(".sp-choose"),Q=H.find(".sp-palette-toggle"),K=z.is("input"),e=K&&Ne&&"color"===z.attr("type"),Y=K&&!l,Z=Y?Fe(Ee).addClass(o).addClass(s.className).addClass(s.replacerClassName):Fe([]),ee=Y?Z:z,te=Z.find(".sp-preview-inner"),ae=s.color||K&&z.val(),ne=!1,ie=s.preferredFormat,re=ie,oe=!s.showButtons||s.clickoutFiresChange,se=!ae,le=s.allowEmpty&&!e;function de(){if(s.showPaletteOnly&&(s.showPalette=!0),Q.text(s.showPaletteOnly?s.togglePaletteMoreText:s.togglePaletteLessText),s.palette){x=s.palette.slice(0),S=Fe.isArray(x[0])?x:[x],k={};for(var e=0;e<S.length;e++)for(var t=0;t<S[e].length;t++){var a=tinycolor(S[e][t]).toRgbString();k[a]=!0}}H.toggleClass("sp-flat",l),H.toggleClass("sp-input-disabled",!s.showInput),H.toggleClass("sp-alpha-enabled",s.showAlpha),H.toggleClass("sp-clear-enabled",le),H.toggleClass("sp-buttons-disabled",!s.showButtons),H.toggleClass("sp-palette-buttons-disabled",!s.togglePaletteOnly),H.toggleClass("sp-palette-disabled",!s.showPalette),H.toggleClass("sp-palette-only",s.showPaletteOnly),H.toggleClass("sp-initial-disabled",!s.showInitial),H.addClass(s.className).addClass(s.containerClassName),Pe()}function pe(){if(p&&window.localStorage){try{var e=window.localStorage[p].split(",#");1<e.length&&(delete window.localStorage[p],Fe.each(e,function(e,t){ce(t)}))}catch(e){}try{P=window.localStorage[p].split(";")}catch(e){}}}function ce(e){if(d){e=tinycolor(e).toRgbString();if(!k[e]&&-1===Fe.inArray(e,P))for(P.push(e);P.length>M;)P.shift();if(p&&window.localStorage)try{window.localStorage[p]=P.join(";")}catch(e){}}}function he(){var a=_e(),e=Fe.map(S,function(e,t){return Le(e,a,"sp-palette-row sp-palette-row-"+t,s)});pe(),P&&e.push(Le(function(){var e=[];if(s.showPalette)for(var t=0;t<P.length;t++){var a=tinycolor(P[t]).toRgbString();k[a]||e.push(P[t])}return e.reverse().slice(0,s.maxSelectionSize)}(),a,"sp-palette-row sp-palette-row-selection",s)),U.html(e.join(""))}function ue(){var e,t;s.showInitial&&(e=ne,t=_e(),W.html(Le([e,t],t,"sp-palette-row-initial",s)))}function me(){(f<=0||m<=0||g<=0)&&Pe(),H.addClass(F),R=null,z.trigger("dragstart.spectrum",[_e()])}function fe(){H.removeClass(F),z.trigger("dragstop.spectrum",[_e()])}function be(){var e=B.val();null!==e&&""!==e||!le?(e=tinycolor(e)).isValid()?(Te(e),ke(!0)):B.addClass("sp-validation-error"):(Te(null),ke(!0))}function ge(){(u?$e:ve)()}function ve(){var e=Fe.Event("beforeShow.spectrum");u?Pe():(z.trigger(e,[_e()]),!1===c.beforeShow(_e())||e.isDefaultPrevented()||(function(){for(var e=0;e<ze.length;e++)ze[e]&&ze[e].hide()}(),u=!0,Fe(A).bind("click.spectrum",ye),Fe(window).bind("resize.spectrum",h),Z.addClass("sp-active"),H.removeClass("sp-hidden"),Pe(),xe(),ne=_e(),ue(),c.show(ne),z.trigger("show.spectrum",[ne])))}function ye(e){2!=e.button&&(oe?ke(!0):we(),$e())}function $e(){u&&!l&&(u=!1,Fe(A).unbind("click.spectrum",ye),Fe(window).unbind("resize.spectrum",h),Z.removeClass("sp-active"),H.addClass("sp-hidden"),c.hide(_e()),z.trigger("hide.spectrum",[_e()]))}function we(){Te(ne,!0)}function Te(e,t){var a;tinycolor.equals(e,_e())?xe():(!e&&le?se=!0:(se=!1,e=(a=tinycolor(e)).toHsv(),w=e.h%360/360,T=e.s,_=e.v,C=e.a),xe(),a&&a.isValid()&&!t&&(re=ie||a.getFormat()))}function _e(e){return e=e||{},le&&se?null:tinycolor.fromRatio({h:w,s:T,v:_,a:Math.round(100*C)/100},{format:e.format||re})}function Ce(){xe(),c.move(_e()),z.trigger("move.spectrum",[_e()])}function xe(){B.removeClass("sp-validation-error"),Se();var e=tinycolor.fromRatio({h:w,s:1,v:1});E.css("background-color",e.toHexString());var t=re;C<1&&(0!==C||"name"!==t)&&("hex"!==t&&"hex3"!==t&&"hex6"!==t&&"name"!==t||(t="rgb"));var a,n,i=_e({format:t}),r="";te.removeClass("sp-clear-display"),te.css("background-color","transparent"),!i&&le?te.addClass("sp-clear-display"):(a=i.toHexString(),n=i.toRgbString(),He||1===i.alpha?te.css("background-color",n):(te.css("background-color","transparent"),te.css("filter",i.toFilter())),s.showAlpha&&((e=i.toRgb()).a=0,e="linear-gradient(left, "+(n=tinycolor(e).toRgbString())+", "+a+")",De?O.css("filter",tinycolor(n).toFilter({gradientType:1},a)):(O.css("background","-webkit-"+e),O.css("background","-moz-"+e),O.css("background","-ms-"+e),O.css("background","linear-gradient(to right, "+n+", "+a+")"))),r=i.toString(t)),s.showInput&&B.val(r),s.showPalette&&he(),ue()}function Se(){var e=T,t=_;le&&se?(V.hide(),I.hide(),j.hide()):(V.show(),I.show(),j.show(),e=e*m,t=f-t*f,e=Math.max(-b,Math.min(m-b,e-b)),t=Math.max(-b,Math.min(f-b,t-b)),j.css({top:t+"px",left:e+"px"}),e=C*v,V.css({left:e-y/2+"px"}),e=w*g,I.css({top:e-$+"px"}))}function ke(e){var t=_e(),a="";t&&(a=t.toString(re),ce(t)),K&&z.val(a),e&&(c.change(t),z.trigger("change",[t]))}function Pe(){var e,t,a,n,i,r,o;m=E.width(),f=E.height(),b=j.height(),L.width(),g=L.height(),$=I.height(),v=q.width(),y=V.width(),l||(H.css("position","absolute"),s.offset?H.offset(s.offset):H.offset((t=ee,a=(e=H).outerWidth(),n=e.outerHeight(),i=t.outerHeight(),r=e[0].ownerDocument,o=r.documentElement,e=o.clientWidth+Fe(r).scrollLeft(),r=o.clientHeight+Fe(r).scrollTop(),(t=t.offset()).top+=i,t.left-=Math.min(t.left,t.left+a>e&&a<e?Math.abs(t.left+a-e):0),t.top-=Math.min(t.top,t.top+n>r&&n<r?Math.abs(+(n+i)):0),t))),Se(),s.showPalette&&he(),z.trigger("reflow.spectrum")}function Me(){$e(),D=!0,z.attr("disabled",!0),ee.addClass("sp-disabled")}!function(){function e(e){return e.data&&e.data.ignore?(Te(Fe(e.target).closest(".sp-thumb-el").data("color")),Ce()):(Te(Fe(e.target).closest(".sp-thumb-el").data("color")),Ce(),ke(!0),s.hideAfterPaletteSelect&&$e()),!1}De&&H.find("*:not(input)").attr("unselectable","on"),de(),Y&&z.after(Z).hide(),le||J.hide(),l?z.after(H).hide():(t=1!==(t="parent"===s.appendTo?z.parent():Fe(s.appendTo)).length?Fe("body"):t).append(H),pe(),ee.bind("click.spectrum touchstart.spectrum",function(e){D||ge(),e.stopPropagation(),Fe(e.target).is("input")||e.preventDefault()}),!z.is(":disabled")&&!0!==s.disabled||Me(),H.click(Ie),B.change(be),B.bind("paste",function(){setTimeout(be,1)}),B.keydown(function(e){13==e.keyCode&&be()}),X.text(s.cancelText),X.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),we(),$e()}),J.attr("title",s.clearText),J.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),se=!0,Ce(),l&&ke(!0)}),G.text(s.chooseText),G.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),B.hasClass("sp-validation-error")||(ke(!0),$e())}),Q.text(s.showPaletteOnly?s.togglePaletteMoreText:s.togglePaletteLessText),Q.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),s.showPaletteOnly=!s.showPaletteOnly,s.showPaletteOnly||l||H.css("left","-="+(N.outerWidth(!0)+5)),de()}),qe(q,function(e,t,a){C=e/v,se=!1,a.shiftKey&&(C=Math.round(10*C)/10),Ce()},me,fe),qe(L,function(e,t){w=parseFloat(t/g),se=!1,s.showAlpha||(C=1),Ce()},me,fe),qe(E,function(e,t,a){a.shiftKey?R||(a=T*m,n=f-_*f,n=Math.abs(e-a)>Math.abs(t-n),R=n?"x":"y"):R=null;var n=!R||"y"===R;R&&"x"!==R||(T=parseFloat(e/m)),n&&(_=parseFloat((f-t)/f)),se=!1,s.showAlpha||(C=1),Ce()},me,fe),ae?(Te(ae),xe(),re=ie||tinycolor(ae).format,ce(ae)):xe(),l&&ve();var t=De?"mousedown.spectrum":"click.spectrum touchstart.spectrum";U.delegate(".sp-thumb-el",t,e),W.delegate(".sp-thumb-el:nth-child(1)",t,{ignore:!0},e)}();e={show:ve,hide:$e,toggle:ge,reflow:Pe,option:function(e,t){return e===Re?Fe.extend({},s):t===Re?s[e]:(s[e]=t,void de())},enable:function(){D=!1,z.attr("disabled",!1),ee.removeClass("sp-disabled")},disable:Me,offset:function(e){s.offset=e,Pe()},set:function(e){Te(e),ke()},get:_e,destroy:function(e){z.show(),ee.unbind("click.spectrum touchstart.spectrum"),H.remove(),Z.remove(),ze[e]=null},container:H};return e.id=ze.push(e)-1,e}function a(){}function Ie(e){e.stopPropagation()}function Oe(e,t){var a=Array.prototype.slice,n=a.call(arguments,2);return function(){return e.apply(t,n.concat(a.call(arguments)))}}function qe(n,i,t,e){i=i||function(){},t=t||function(){},e=e||function(){};var r=document,o=!1,s={},l=0,d=0,p="ontouchstart"in window,a={};function c(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function h(e){if(o){if(De&&r.documentMode<9&&!e.button)return u();var t=e.originalEvent&&e.originalEvent.touches,a=(t?t[0]:e).pageX,t=(t?t[0]:e).pageY,a=Math.max(0,Math.min(a-s.left,d)),t=Math.max(0,Math.min(t-s.top,l));p&&c(e),i.apply(n,[a,t,e])}}function u(){o&&(Fe(r).unbind(a),Fe(r.body).removeClass("sp-dragging"),e.apply(n,arguments)),o=!1}a.selectstart=c,a.ragstart=c,a["touchmove mousemove"]=h,a["touchend mouseup"]=u,Fe(n).bind("touchstart mousedown",function(e){(e.which?3==e.which:2==e.button)||o||!1!==t.apply(n,arguments)&&(o=!0,l=Fe(n).height(),d=Fe(n).width(),s=Fe(n).offset(),Fe(r).bind(a),Fe(r.body).addClass("sp-dragging"),p||h(e),c(e))})}var o="spectrum.id";Fe.fn.spectrum=function(a,e){if("string"!=typeof a)return this.spectrum("destroy").each(function(){var e=r(this,Fe.extend({},a,Fe(this).data()));Fe(this).data(o,e.id)});var n=this,i=Array.prototype.slice.call(arguments,1);return this.each(function(){var e=ze[Fe(this).data(o)];if(e){var t=e[a];if(!t)throw new Error("Spectrum: no such method: '"+a+"'");"get"==a?n=e.get():"container"==a?n=e.container:"option"==a?n=e.option.apply(e,i):"destroy"==a?(e.destroy(e.id),Fe(this).removeData(o)):t.apply(e,i)}}),n},Fe.fn.spectrum.load=!0,Fe.fn.spectrum.loadOpts={},Fe.fn.spectrum.draggable=qe,Fe.fn.spectrum.defaults=Ae,Fe.spectrum={},Fe.spectrum.localization={},Fe.spectrum.palettes={},Fe.fn.spectrum.processNativeColorInputs=function(){Ne||Fe("input[type=color]").spectrum({preferredFormat:"hex6"})},function(){function l(e,t){if(t=t||{},(e=e||"")instanceof l)return e;if(!(this instanceof l))return new l(e,t);var a=function(e){var t={r:0,g:0,b:0},a=1,n=!1,i=!1;"string"==typeof e&&(e=function(e){e=e.replace(r,"").replace(o,"").toLowerCase();var t,a=!1;if(k[e])e=k[e],a=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};if(t=N.rgb.exec(e))return{r:t[1],g:t[2],b:t[3]};if(t=N.rgba.exec(e))return{r:t[1],g:t[2],b:t[3],a:t[4]};if(t=N.hsl.exec(e))return{h:t[1],s:t[2],l:t[3]};if(t=N.hsla.exec(e))return{h:t[1],s:t[2],l:t[3],a:t[4]};if(t=N.hsv.exec(e))return{h:t[1],s:t[2],v:t[3]};if(t=N.hsva.exec(e))return{h:t[1],s:t[2],v:t[3],a:t[4]};if(t=N.hex8.exec(e))return{a:function(e){return R(e)/255}(t[1]),r:R(t[2]),g:R(t[3]),b:R(t[4]),format:a?"name":"hex8"};if(t=N.hex6.exec(e))return{r:R(t[1]),g:R(t[2]),b:R(t[3]),format:a?"name":"hex"};if(t=N.hex3.exec(e))return{r:R(t[1]+""+t[1]),g:R(t[2]+""+t[2]),b:R(t[3]+""+t[3]),format:a?"name":"hex"};return!1}(e));"object"==typeof e&&(e.hasOwnProperty("r")&&e.hasOwnProperty("g")&&e.hasOwnProperty("b")?(t=function(e,t,a){return{r:255*M(e,255),g:255*M(t,255),b:255*M(a,255)}}(e.r,e.g,e.b),n=!0,i="%"===String(e.r).substr(-1)?"prgb":"rgb"):e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("v")?(e.s=z(e.s),e.v=z(e.v),t=function(e,t,a){e=6*M(e,360),t=M(t,100),a=M(a,100);var n=s.floor(e),i=e-n,r=a*(1-t),e=a*(1-i*t),t=a*(1-(1-i)*t),n=n%6;return{r:255*[a,e,r,r,t,a][n],g:255*[t,a,a,e,r,r][n],b:255*[r,r,t,a,a,e][n]}}(e.h,e.s,e.v),n=!0,i="hsv"):e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("l")&&(e.s=z(e.s),e.l=z(e.l),t=function(e,t,a){var n,i,r;function o(e,t,a){return a<0&&(a+=1),1<a&&--a,a<1/6?e+6*(t-e)*a:a<.5?t:a<2/3?e+(t-e)*(2/3-a)*6:e}e=M(e,360),t=M(t,100),a=M(a,100),0===t?n=i=r=a:(n=o(t=2*a-(a=a<.5?a*(1+t):a+t-a*t),a,e+1/3),i=o(t,a,e),r=o(t,a,e-1/3));return{r:255*n,g:255*i,b:255*r}}(e.h,e.s,e.l),n=!0,i="hsl"),e.hasOwnProperty("a")&&(a=e.a));return a=P(a),{ok:n,format:e.format||i,r:d(255,p(t.r,0)),g:d(255,p(t.g,0)),b:d(255,p(t.b,0)),a:a}}(e);this._originalInput=e,this._r=a.r,this._g=a.g,this._b=a.b,this._a=a.a,this._roundA=i(100*this._a)/100,this._format=t.format||a.format,this._gradientType=t.gradientType,this._r<1&&(this._r=i(this._r)),this._g<1&&(this._g=i(this._g)),this._b<1&&(this._b=i(this._b)),this._ok=a.ok,this._tc_id=n++}var e=null,r=/^[\s,#]+/,o=/\s+$/,n=0,s=Math,i=s.round,d=s.min,p=s.max,t=s.random;function c(e,t,a){e=M(e,255),t=M(t,255),a=M(a,255);var n,i=p(e,t,a),r=d(e,t,a),o=(i+r)/2;if(i==r)n=l=0;else{var s=i-r,l=.5<o?s/(2-i-r):s/(i+r);switch(i){case e:n=(t-a)/s+(t<a?6:0);break;case t:n=(a-e)/s+2;break;case a:n=(e-t)/s+4}n/=6}return{h:n,s:l,l:o}}function h(e,t,a){e=M(e,255),t=M(t,255),a=M(a,255);var n,i=p(e,t,a),r=d(e,t,a),o=i,s=i-r,l=0===i?0:s/i;if(i==r)n=0;else{switch(i){case e:n=(t-a)/s+(t<a?6:0);break;case t:n=(a-e)/s+2;break;case a:n=(e-t)/s+4}n/=6}return{h:n,s:l,v:o}}function a(e,t,a,n){a=[A(i(e).toString(16)),A(i(t).toString(16)),A(i(a).toString(16))];return n&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0):a.join("")}function u(e,t,a,n){return[A(Math.round(255*parseFloat(n)).toString(16)),A(i(e).toString(16)),A(i(t).toString(16)),A(i(a).toString(16))].join("")}function m(e,t){t=0===t?0:t||10;e=l(e).toHsl();return e.s-=t/100,e.s=F(e.s),l(e)}function f(e,t){t=0===t?0:t||10;e=l(e).toHsl();return e.s+=t/100,e.s=F(e.s),l(e)}function b(e){return l(e).desaturate(100)}function g(e,t){t=0===t?0:t||10;e=l(e).toHsl();return e.l+=t/100,e.l=F(e.l),l(e)}function v(e,t){t=0===t?0:t||10;e=l(e).toRgb();return e.r=p(0,d(255,e.r-i(-t/100*255))),e.g=p(0,d(255,e.g-i(-t/100*255))),e.b=p(0,d(255,e.b-i(-t/100*255))),l(e)}function y(e,t){t=0===t?0:t||10;e=l(e).toHsl();return e.l-=t/100,e.l=F(e.l),l(e)}function $(e,t){e=l(e).toHsl(),t=(i(e.h)+t)%360;return e.h=t<0?360+t:t,l(e)}function w(e){e=l(e).toHsl();return e.h=(e.h+180)%360,l(e)}function T(e){var t=l(e).toHsl(),a=t.h;return[l(e),l({h:(a+120)%360,s:t.s,l:t.l}),l({h:(a+240)%360,s:t.s,l:t.l})]}function _(e){var t=l(e).toHsl(),a=t.h;return[l(e),l({h:(a+90)%360,s:t.s,l:t.l}),l({h:(a+180)%360,s:t.s,l:t.l}),l({h:(a+270)%360,s:t.s,l:t.l})]}function C(e){var t=l(e).toHsl(),a=t.h;return[l(e),l({h:(a+72)%360,s:t.s,l:t.l}),l({h:(a+216)%360,s:t.s,l:t.l})]}function x(e,t,a){t=t||6,a=a||30;var n=l(e).toHsl(),i=360/a,r=[l(e)];for(n.h=(n.h-(i*t>>1)+720)%360;--t;)n.h=(n.h+i)%360,r.push(l(n));return r}function S(e,t){t=t||6;for(var e=l(e).toHsv(),a=e.h,n=e.s,i=e.v,r=[],o=1/t;t--;)r.push(l({h:a,s:n,v:i})),i=(i+o)%1;return r}l.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},setAlpha:function(e){return this._a=P(e),this._roundA=i(100*this._a)/100,this},toHsv:function(){var e=h(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=h(this._r,this._g,this._b),t=i(360*e.h),a=i(100*e.s),e=i(100*e.v);return 1==this._a?"hsv("+t+", "+a+"%, "+e+"%)":"hsva("+t+", "+a+"%, "+e+"%, "+this._roundA+")"},toHsl:function(){var e=c(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=c(this._r,this._g,this._b),t=i(360*e.h),a=i(100*e.s),e=i(100*e.l);return 1==this._a?"hsl("+t+", "+a+"%, "+e+"%)":"hsla("+t+", "+a+"%, "+e+"%, "+this._roundA+")"},toHex:function(e){return a(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(){return u(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:i(this._r),g:i(this._g),b:i(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+i(this._r)+", "+i(this._g)+", "+i(this._b)+")":"rgba("+i(this._r)+", "+i(this._g)+", "+i(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:i(100*M(this._r,255))+"%",g:i(100*M(this._g,255))+"%",b:i(100*M(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+i(100*M(this._r,255))+"%, "+i(100*M(this._g,255))+"%, "+i(100*M(this._b,255))+"%)":"rgba("+i(100*M(this._r,255))+"%, "+i(100*M(this._g,255))+"%, "+i(100*M(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&e[a(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var t="#"+u(this._r,this._g,this._b,this._a),a=t;return"progid:DXImageTransform.Microsoft.gradient("+(this._gradientType?"GradientType = 1, ":"")+"startColorstr="+t+",endColorstr="+(a=e?l(e).toHex8String():a)+")"},toString:function(e){var t=!!e;e=e||this._format;var a=!1,n=this._a<1&&0<=this._a;return t||!n||"hex"!==e&&"hex6"!==e&&"hex3"!==e&&"name"!==e?("rgb"===e&&(a=this.toRgbString()),"prgb"===e&&(a=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(a=this.toHexString()),"hex3"===e&&(a=this.toHexString(!0)),"hex8"===e&&(a=this.toHex8String()),"name"===e&&(a=this.toName()),"hsl"===e&&(a=this.toHslString()),(a="hsv"===e?this.toHsvString():a)||this.toHexString()):"name"===e&&0===this._a?this.toName():this.toRgbString()},_applyModification:function(e,t){t=e.apply(null,[this].concat([].slice.call(t)));return this._r=t._r,this._g=t._g,this._b=t._b,this.setAlpha(t._a),this},lighten:function(){return this._applyModification(g,arguments)},brighten:function(){return this._applyModification(v,arguments)},darken:function(){return this._applyModification(y,arguments)},desaturate:function(){return this._applyModification(m,arguments)},saturate:function(){return this._applyModification(f,arguments)},greyscale:function(){return this._applyModification(b,arguments)},spin:function(){return this._applyModification($,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(x,arguments)},complement:function(){return this._applyCombination(w,arguments)},monochromatic:function(){return this._applyCombination(S,arguments)},splitcomplement:function(){return this._applyCombination(C,arguments)},triad:function(){return this._applyCombination(T,arguments)},tetrad:function(){return this._applyCombination(_,arguments)}},l.fromRatio=function(e,t){if("object"==typeof e){var a,n={};for(a in e)e.hasOwnProperty(a)&&(n[a]="a"===a?e[a]:z(e[a]));e=n}return l(e,t)},l.equals=function(e,t){return!(!e||!t)&&l(e).toRgbString()==l(t).toRgbString()},l.random=function(){return l.fromRatio({r:t(),g:t(),b:t()})},l.mix=function(e,t,a){a=0===a?0:a||50;var n=l(e).toRgb(),i=l(t).toRgb(),e=a/100,t=2*e-1,a=i.a-n.a,t=t*a==-1?t:(t+a)/(1+t*a),a=1-(t=(t+1)/2),e={r:i.r*t+n.r*a,g:i.g*t+n.g*a,b:i.b*t+n.b*a,a:i.a*e+n.a*(1-e)};return l(e)},l.readability=function(e,t){var a=l(e),n=l(t),e=a.toRgb(),t=n.toRgb(),a=a.getBrightness(),n=n.getBrightness(),t=Math.max(e.r,t.r)-Math.min(e.r,t.r)+Math.max(e.g,t.g)-Math.min(e.g,t.g)+Math.max(e.b,t.b)-Math.min(e.b,t.b);return{brightness:Math.abs(a-n),color:t}},l.isReadable=function(e,t){t=l.readability(e,t);return 125<t.brightness&&500<t.color},l.mostReadable=function(e,t){for(var a=null,n=0,i=!1,r=0;r<t.length;r++){var o=l.readability(e,t[r]),s=125<o.brightness&&500<o.color,o=o.brightness/125*3+o.color/500;(s&&!i||s&&i&&n<o||!s&&!i&&n<o)&&(i=s,n=o,a=l(t[r]))}return a};var k=l.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};function P(e){return e=parseFloat(e),e=isNaN(e)||e<0||1<e?1:e}function M(e,t){"string"==typeof(a=e)&&-1!=a.indexOf(".")&&1===parseFloat(a)&&(e="100%");var a,a="string"==typeof(a=e)&&-1!=a.indexOf("%");return e=d(t,p(0,parseFloat(e))),a&&(e=parseInt(e*t,10)/100),s.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function F(e){return d(1,p(0,e))}function R(e){return parseInt(e,16)}function A(e){return 1==e.length?"0"+e:""+e}function z(e){return e=e<=1?100*e+"%":e}var D,H,e=l.hexNames=function(e){var t,a={};for(t in e)e.hasOwnProperty(t)&&(a[e[t]]=t);return a}(k),N=(H="[\\s|\\(]+("+(D="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+D+")[,|\\s]+("+D+")\\s*\\)?",D="[\\s|\\(]+("+D+")[,|\\s]+("+D+")[,|\\s]+("+D+")[,|\\s]+("+D+")\\s*\\)?",{rgb:new RegExp("rgb"+H),rgba:new RegExp("rgba"+D),hsl:new RegExp("hsl"+H),hsla:new RegExp("hsla"+D),hsv:new RegExp("hsv"+H),hsva:new RegExp("hsva"+D),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});window.tinycolor=l}(),Fe(function(){Fe.fn.spectrum.load&&Fe.fn.spectrum.processNativeColorInputs()})}),(Pharmit=Pharmit||{}).Viewer=function(){"use strict";return function(e){function i(e){return!e||(e=e.split(".")).length<=1?"":e.pop()}function p(e){var t=(n=f[e]).selectedStyle,a=n.styles[t],e=a.style,t=a.nonbond,n=n.model;r&&(c&&u.removeSurface(c),c=r,u.setSurfaceMaterialStyle(c,h),r=null),n&&(n.setStyle({},e),n.setStyle({bonds:0},t),a.dynamic&&a.dynamic()),u.render()}function s(t,e,a){var n=f[t],i=$("<tr>").appendTo(e).addClass("pharmit_styleselectrow"),r=t+"MolStyleSelect";$('<label for="'+r+'">'+t+":</label>").appendTo(i).addClass("pharmit_stylelabel").appendTo($("<td>").appendTo(i));var o=$("<td nowrap>").appendTo(i),s=$('<select name="'+r+'" id="'+r+'">').appendTo(o).addClass("pharmit_styleselector");$.each(n.styles,function(e,t){$('<option value="'+e+'">'+t.name+"</option>").appendTo(s)}),s.val(n.selectedstyle),s.selectmenu({width:"11em",appendTo:e,change:function(){s.change()},position:{my:"left top",at:"left bottom",collision:"flip"}}),s.selectmenu("widget").css("width","");var l=n.colorscheme;$.each(n.styles,function(e,t){$.each(t.style,function(e,t){t.colorscheme=l})}),s.change(function(){n.selectedStyle=this.value,s.selectmenu("refresh"),p(t)});var d=$('<input name="'+r+'color">').appendTo($("<td>").appendTo(i));d.val(n.defaultColor),d.change(function(){var e=this.value;d.spectrum("set",e);e=parseInt(d.spectrum("get").toHex(),16);n.colorscheme.C=e,p(t)}),d.spectrum({showPalette:!0,preferredFormat:"hex",replacerClassName:"ui-state-default ui-corner-all",showPaletteOnly:!0,clickoutFiresChange:!0,palette:["#C8C8C8","gray","white","green","cyan","magenta","yellow","orange","purple","blue"],change:function(e){d.change()}}),s.change(),d.change(),s.selectmenu("refresh")}$3Dmol.elementColors;var a={left:0,right:0},l={Aromatic:"purple",HydrogenDonor:"0xf0f0f0",HydrogenAcceptor:"orange",Hydrophobic:"green",NegativeIon:"red",PositiveIon:"blue",ExclusionSphere:"grey",InclusionSphere:"yellow"},d={Aromatic:1.5,HydrogenDonor:2,HydrogenAcceptor:1,Hydrophobic:1,NegativeIon:1.5,PositiveIon:1.5,ExclusionSphere:1.5,InclusionSphere:1.5},c=null,r=null,h={map:{prop:"partialCharge",scheme:new $3Dmol.Gradient.RWB(-.8,.8)},opacity:.8},u=null,m=[],f={Ligand:{model:null,defaultColor:"#C8C8C8",colorscheme:$.extend({},$3Dmol.elementColors.defaultColors),selectedstyle:"stick",styles:{stick:{name:"Stick",style:{stick:{radius:.15}},nonbond:{sphere:{radius:.15}}},wire:{name:"Wire",style:{line:{linewidth:2}},nonbond:{sphere:{radius:.05}}},sphere:{name:"Sphere",style:{sphere:{}},nonbond:{sphere:{}}},none:{name:"None",style:{},nonbond:{}}}},Receptor:{model:null,defaultColor:"#C8C8C8",colorscheme:$.extend({},$3Dmol.elementColors.defaultColors),backbone:null,selectedstyle:"cartoonwire",styles:{stick:{name:"Stick",style:{stick:{radius:.1}},nonbond:{sphere:{radius:.1}}},wire:{name:"Wire",style:{line:{linewidth:3}},nonbond:{sphere:{radius:.05}}},sphere:{name:"Sphere",style:{sphere:{}},nonbond:{sphere:{}}},cartoon:{name:"Cartoon",style:{cartoon:{}},nonbond:{sphere:{radius:.1}}},cartoonwire:{name:"Cartoon+Wire",style:{cartoon:{},line:{linewidth:3}},nonbond:{sphere:{radius:.2}}},bindingsite:{name:"Binding Site",style:{cartoon:{},line:{linewidth:3}},nonbond:{sphere:{radius:.2}},dynamic:function(){var n,e=f.Ligand.model,t=f.Receptor.model;e&&t&&(n=e.selectedAtoms(),t.setStyle({model:t,byres:!0,predicate:e=function(e){for(var t=0;t<n.length;t++){var a=n[t];if((e.x-a.x)*(e.x-a.x)+(e.y-a.y)*(e.y-a.y)+(e.z-a.z)*(e.z-a.z)<36)return!0}return!1}},{stick:{radius:.1,colorscheme:f.Receptor.colorscheme}},!0),null!==c&&(u.setSurfaceMaterialStyle(c,{opacity:0}),r=c),t=u.addSurface($3Dmol.SurfaceType.VDW,h,{model:t,byres:!0,predicate:e},{model:t,bonds:0,invert:!0}),c=t.surfid)}},none:{name:"None",style:{},nonbond:{}}}},Results:{model:null,defaultColor:"gray",colorscheme:$.extend({},$3Dmol.elementColors.defaultColors),selectedstyle:"stick",styles:{stick:{name:"Stick",style:{stick:{radius:.25}},nonbond:{sphere:{radius:.25}}},wire:{name:"Wire",style:{line:{linewidth:4}},nonbond:{sphere:{radius:.1}}},sphere:{name:"Sphere",style:{sphere:{}},nonbond:{sphere:{}}},none:{name:"None",style:{},nonbond:{}}}}};this.appendViewerControls=function(e){var t=$("<table>").appendTo(e);s("Ligand",t),s("Results",t),s("Receptor",t);var a=$("<div>").addClass("pharmit_backbonediv").appendTo(e);$('<label for="receptorbackbone">Receptor Backbone:</label>').appendTo(a);var n=$('<div id="receptorbackbone">').appendTo(a);$('<input type="radio" id="plainBackbone" name="receptorbackbone"><label for="plainBackbone">Plain</label>').appendTo(n).change(function(){var e;$(this).prop("checked")&&(delete(e=f.Receptor).styles.cartoon.style.cartoon.color,delete e.styles.cartoonwire.style.cartoon.color,p("Receptor")),n.buttonset("refresh")}).prop("checked",!0),$('<input type="radio" id="rainbowBackbone" name="receptorbackbone"><label for="rainbowBackbone">Rainbow</label>').appendTo(n).change(function(){var e;$(this).prop("checked")&&((e=f.Receptor).styles.cartoon.style.cartoon.color="spectrum",e.styles.cartoonwire.style.cartoon.color="spectrum",p("Receptor")),n.buttonset("refresh")}),n.buttonset();t=$("<div>").addClass("pharmit_surfacetransparencydiv").appendTo(e);$('<label for="surfaceopacity">Receptor Surface Opacity:</label>').appendTo(t);var a=$("<div>").addClass("pharmit_surfacetransparencyslider").appendTo(t),i=$('<input type="hidden" name="surfaceopacity">').appendTo(t);i.val(.8);var r=$('<div id="surfaceopacity">').appendTo(a).slider({animate:"fast",step:.05,min:0,max:1,value:.8,change:function(e,t){i.val(t.value).change()}});i.change(function(){var e=i.val();h.opacity=e,null!==c&&u.setSurfaceMaterialStyle(c,h),r.slider("value")!=e&&r.slider("value",e),u.render()});e=$("<div>").addClass("pharmit_backgroundcolordiv").appendTo(e);$('<label for="backgroundcolor">Background Color:</label>').appendTo(e);var o=$('<div id="backgroundcolor">').appendTo(e);$('<input type="radio" id="whiteBackground" name="backgroundcolor"><label for="whiteBackground">White</label>').appendTo(o).change(function(){$(this).prop("checked")&&u.setBackgroundColor("white"),o.buttonset("refresh")}).prop("checked",!0),$('<input type="radio" id="blackBackground" name="backgroundcolor"><label for="blackBackground">Black</label>').appendTo(o).change(function(){$(this).prop("checked")&&u.setBackgroundColor("black"),o.buttonset("refresh")}),o.buttonset()},this.setReceptor=function(e,t){var a,n=f.Receptor.model;n&&u.removeModel(n),(n=null)!==c&&u.removeSurface(c),c=null,e?(t=i(t),n=u.addModel(e,t),f.Receptor.model=n,p("Receptor"),u.mapAtomProperties($3Dmol.applyPartialCharges,{model:n}),t=u.addSurface($3Dmol.SurfaceType.VDW,h,{model:n,bonds:0,invert:!0}),c=t.surfid,u.zoomTo({}),a=null,n.setHoverable({},!0,function(e){e.resn&&e.resi&&(a=u.addLabel(e.resn+e.resi+":"+e.atom,{position:e,fontSize:12,backgroundColor:"#2c1943",backgroundOpacity:.5,alignment:"bottomCenter"}),u.render())},function(){u.removeLabel(a),u.render()})):u.render()},this.setLigand=function(e,t){var a=f.Ligand.model;a&&u.removeModel(a),a=null,e?(t=i(t),a=u.addModel(e,t),f.Ligand.model=a,p("Ligand"),p("Receptor"),u.zoomTo({model:a})):u.render()},this.setResult=function(e){var t=f.Results.model;t&&u.removeModel(t),e?(t=u.addModel(e,"sdf"),f.Results.model=t,p("Results"),u.zoomTo({model:t})):u.render()},this.setView=function(e){e?u.setView(e):u.zoomTo()},this.getView=function(){return u.getView()},this.addMesh=function(e,t){"exclusive"==t.kind?e.color="grey":"inclusive"==t.kind&&(e.color="yellow"),$.extend(e,t);e=u.addCustom(e);return u.render(),e},this.updateMesh=function(e,t){e&&(e.updateStyle&&e.updateStyle(t),u.render())},this.removeMesh=function(e){u.removeShape(e),u.render()},this.hideMesh=function(e){},this.unhideMesh=function(e){},this.addFeature=function(e,t){var a,n,i,r={center:{x:e.x,y:e.y,z:e.z},radius:e.radius,color:l[e.name],quality:d[e.name],wireframe:!0,linewidth:1.5,clickable:!0,callback:t},o={sphere:null,arrows:[],label:null};return o.sphere=u.addSphere(r),e.selected&&o.sphere.updateStyle({wireframe:!1}),e.hasvec&&e.vector_on&&e.svector&&(n=new $3Dmol.Vector3(e.svector.x,e.svector.y,e.svector.z),i=((a=e.radius+1)-.5)/a,i={start:t=(n=n.normalize()).clone().multiplyScalar(e.radius).add(e),end:r=n.clone().multiplyScalar(a).add(e),radius:.075,radiusRatio:2,mid:i,wireframe:!e.selected,color:l[e.name]},o.arrows.push(u.addArrow(i)),"Aromatic"==e.name&&(t=n.clone().multiplyScalar(-e.radius).add(e),r=n.clone().multiplyScalar(-a).add(e),i.start=t,i.end=r,o.arrows.push(u.addArrow(i)))),"Hydrophobic"!=e.name||":"!=(i=e.minsize+":"+e.maxsize)&&(e={position:{x:e.x,y:e.y,z:e.z},showBackground:!0,fontColor:"black",backgroundColor:l[e.name],backgroundOpacity:.5,alignment:$3Dmol.SpriteAlignment.center},o.label=u.addLabel(i,e)),u.render(),m.push(o),m.length-1},this.selectFeature=function(e){e=m[e];e&&e.sphere&&(e.sphere.updateStyle({wireframe:!1}),$.each(e.arrows,function(e,t){t.updateStyle({wireframe:!1})}),u.render())},this.unselectFeature=function(e){e=m[e];e&&e.sphere&&(e.sphere.updateStyle({wireframe:!0}),$.each(e.arrows,function(e,t){t.updateStyle({wireframe:!0})}),u.render())},this.removeFeature=function(e){var t=m[e];for(t&&(t.sphere&&u.removeShape(t.sphere),$.each(t.arrows,function(e,t){u.removeShape(t)}),t.label&&u.removeLabel(t.label),u.render()),delete m[e];0<m.length&&void 0===m[m.length-1];)m.pop()},this.setLeft=function(e){var t=e-a.left;a.left=e,u.translate(t/2,0)},this.setRight=function(e){var t=a.right-e;a.right=e,u.translate(t/2,0)};var t=null;this.disableRendering=function(){t=u.render,u.render=function(){}},this.enableRendering=function(){t&&(u.render=t),u.render()},(u=new $3Dmol.GLViewer(e)).setBackgroundColor("white"),e.bind("mousemove touchmove",u._handleMouseMove)}}();Pharmit=Pharmit||{};$(document).ready(function(){Pharmit.server="/fcgi-bin/pharmitserv.fcgi",Pharmit.email="dkoes@pitt.edu";var e,a={};for(e in window)a[e]=!0;$(document).tooltip(),Pharmit.inFormSubmit=!1,Pharmit.checkGlobals=function(){var e,t=[];for(e in window)e in a||t.push(e);0<t.length&&console.log("Leaked global variables: ["+t.join(", ")+"]")};function t(e){return e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),null===(e=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.href))?null:e[1]}var n=$("#pharmit").addClass("pharmit_main"),i=new Pharmit.Viewer(n),r=new Pharmit.Results(n,i),o=new Pharmit.Query(n,i,r);t("SESSION")&&$.get(decodeURI(t("SESSION")),function(e){o.loadSession(e)}),Pharmit.checkGlobals(),$("button, input[type='button'], input[type='submit']").button().bind("mouseup",function(){$(this).blur()});window.addEventListener("message",function(e){if("ack"==e.data)e.source.postMessage("ack2","*");else if("ack2"!=e.data&&!(e.data.type&&"init"==e.data.type||e.contexts||e.data&&!0===e.data))try{var t=$.parseJSON(e.data);t.points?o.loadSession(t):o.setLigandAndReceptor(t.ligand,t.ligandFormat,t.receptor,t.recname)}catch(e){console.log("Communication error: "+e)}})});